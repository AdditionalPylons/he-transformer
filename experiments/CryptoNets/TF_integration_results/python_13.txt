(he3) ➜  cryptonets git:(fboemer/update_cryptonets_timings) ✗ NGRAPH_TF_VLOG_LEVEL=5 NGRAPH_BATCHED_TENSOR=1 NGRAPH_BATCHED_TENSOR=1 NGRAPH_HE_SEAL_CONFIG=../../test/model/he_seal_ckks_config_13.json NGRAPH_TF_BACKEND=HE:SEAL:CKKS python test.py --batch_size=1
TensorFlow version installed: 1.12.0 (v1.12.0-0-ga6d8ffae09)
nGraph bridge built with: 1.12.0 (v1.12.0-0-ga6d8ffae09)
Extracting /tmp/tensorflow/mnist/input_data/train-images-idx3-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/train-labels-idx1-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/t10k-images-idx3-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/t10k-labels-idx1-ubyte.gz
2018-11-14 08:37:15.774437: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
starting warmup timer
2018-11-14 08:37:15.807629: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-14 08:37:15.807661: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-14 08:37:15.807671: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-14 08:37:15.807679: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-14 08:37:15.807687: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-14 08:37:15.807695: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-14 08:37:15.807707: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-14 08:37:15.807716: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-14 08:37:15.807727: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-14 08:37:15.807738: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-14 08:37:15.807747: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-14 08:37:15.807757: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-14 08:37:15.807766: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-14 08:37:15.807775: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-14 08:37:15.807782: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-14 08:37:15.807789: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-14 08:37:15.807796: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/MatMul_0_0
2018-11-14 08:37:15.807802: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:37:15.807845: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-14 08:37:15.807863: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-14 08:37:15.807872: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-14 08:37:15.807881: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-14 08:37:15.807891: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-14 08:37:15.807900: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-14 08:37:15.807908: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-14 08:37:15.807917: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-14 08:37:15.807926: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-14 08:37:15.807935: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-14 08:37:15.807944: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-14 08:37:15.807953: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-14 08:37:15.807961: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-14 08:37:15.807970: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-14 08:37:15.807979: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for _arg_Placeholder_0_0[_Arg]
2018-11-14 08:37:15.807987: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:37:15.808058: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-14 08:37:15.808081: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-14 08:37:15.808099: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-14 08:37:15.808113: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-14 08:37:15.808128: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-14 08:37:15.808145: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-14 08:37:15.808160: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-14 08:37:15.808180: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-14 08:37:15.808194: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-14 08:37:15.808217: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-14 08:37:15.808231: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-14 08:37:15.808252: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-14 08:37:15.808268: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-14 08:37:15.808282: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-14 08:37:15.808304: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:37:15.808312: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:37:15.808335: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:37:15.808344: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:37:15.808350: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-14 08:37:15.808365: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-14 08:37:15.808382: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5d4e0 :: reshape/Reshape/shape [Const]
2018-11-14 08:37:15.808408: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5d558 :: conv1/Const [Const]
2018-11-14 08:37:15.808416: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5d5d0 :: conv1/pad_const [Const]
2018-11-14 08:37:15.808424: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5d648 :: fc1/Reshape/shape [Const]
2018-11-14 08:37:15.808432: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5d6c0 :: squash/Const [Const]
2018-11-14 08:37:15.808439: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5d738 :: fc2/Const [Const]
2018-11-14 08:37:15.808446: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5d7b0 :: reshape/Reshape [Reshape]
2018-11-14 08:37:15.808454: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5d868 :: conv1/Conv2D [Conv2D]
2018-11-14 08:37:15.808462: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5d920 :: conv1/Square [Square]
2018-11-14 08:37:15.808469: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5d9b8 :: conv1/Pad [Pad]
2018-11-14 08:37:15.808477: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5da70 :: fc1/Reshape [Reshape]
2018-11-14 08:37:15.808485: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5db28 :: fc1/MatMul [MatMul]
2018-11-14 08:37:15.808492: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5dbe0 :: fc1/Square [Square]
2018-11-14 08:37:15.808500: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x3d5dc78 :: fc2/MatMul [MatMul]
2018-11-14 08:37:15.808568: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-14 08:37:15.808618: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 0 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-14 08:37:15.808655: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 0, datatype: 1
2018-11-14 08:37:15.808708: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 0 to _retval_fc2/MatMul_0_0[0] in -1, datatype: 1
2018-11-14 08:37:15.810232: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-14 08:37:15.810266: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-14T16:37:15z src/seal/ckks/he_seal_ckks_backend.cpp 69	Using SEAL CKKS config with 7 30-bit coefficients
[INFO] 2018-11-14T16:37:16z src/seal/he_seal_util.hpp 45
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
[INFO] 2018-11-14T16:37:16z src/seal/ckks/he_seal_ckks_backend.cpp 115	Creating backend
2018-11-14 08:37:16.949974: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 0
2018-11-14 08:37:16.950031: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-14 08:37:16.950044: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 0
2018-11-14 08:37:16.950053: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_0
2018-11-14 08:37:16.950190: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-14 08:37:16.950305: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-14 08:37:16.950329: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-14 08:37:16.950356: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-14 08:37:16.950405: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-14 08:37:16.950457: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-14 08:37:16.950477: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-14 08:37:16.950485: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-14 08:37:16.950490: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-14 08:37:16.950496: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-14 08:37:16.950511: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-14 08:37:16.950544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-14 08:37:16.950552: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-14 08:37:16.950559: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-14 08:37:16.950568: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-14 08:37:16.950600: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-14 08:37:16.950614: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-14 08:37:16.950621: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-14 08:37:16.950733: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-14 08:37:16.950769: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-14 08:37:16.950813: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-14 08:37:16.950848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-14 08:37:16.950873: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-14 08:37:16.950883: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-14 08:37:16.950890: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-14 08:37:16.950948: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-14 08:37:16.950978: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-14 08:37:16.950992: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-14 08:37:16.951006: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-14 08:37:16.951041: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-14 08:37:16.951834: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-14 08:37:16.951889: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-14 08:37:16.951929: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-14 08:37:16.951970: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-14 08:37:16.952108: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 0
2018-11-14 08:37:16.952135: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 0
[INFO] 2018-11-14T16:37:16z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:37:16z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 784
2018-11-14 08:37:17.463247: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 0
[INFO] 2018-11-14T16:37:17z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:37:17z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 10
2018-11-14 08:37:17.490493: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 0
2018-11-14 08:37:17.490509: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 0
[INFO] 2018-11-14T16:37:17z src/he_backend.cpp 351	[ Parameter_0 ]
[INFO] 2018-11-14T16:37:17z src/he_backend.cpp 351	[ Constant_17 ]
[INFO] 2018-11-14T16:37:17z src/he_backend.cpp 447	Constant_17 took 0s
[INFO] 2018-11-14T16:37:17z src/he_backend.cpp 351	[ Constant_14 ]
[INFO] 2018-11-14T16:37:20z src/he_backend.cpp 447	Constant_14 took 2s
[INFO] 2018-11-14T16:37:20z src/he_backend.cpp 351	[ Constant_10 ]
[INFO] 2018-11-14T16:37:20z src/he_backend.cpp 447	Constant_10 took 0s
[INFO] 2018-11-14T16:37:20z src/he_backend.cpp 351	[ Constant_3 ]
[INFO] 2018-11-14T16:37:20z src/he_backend.cpp 447	Constant_3 took 0s
[INFO] 2018-11-14T16:37:20z src/he_backend.cpp 351	[ Reshape_2 ]
[INFO] 2018-11-14T16:37:20z src/he_backend.cpp 447	Reshape_2 took 0s
[INFO] 2018-11-14T16:37:20z src/he_backend.cpp 351	[ Reshape_5 ]
[INFO] 2018-11-14T16:37:20z src/he_backend.cpp 447	Reshape_5 took 0s
[INFO] 2018-11-14T16:37:20z src/he_backend.cpp 351	[ Reshape_4 ]
[INFO] 2018-11-14T16:37:20z src/he_backend.cpp 447	Reshape_4 took 0s
[INFO] 2018-11-14T16:37:20z src/he_backend.cpp 351	[ Convolution_6 ]
[INFO] 2018-11-14T16:37:20z src/kernel/convolution.hpp 107	out_transform_size 720
[INFO] 2018-11-14T16:37:25z src/he_backend.cpp 447	Convolution_6 took 5s
[INFO] 2018-11-14T16:37:25z src/he_backend.cpp 351	[ Reshape_7 ]
[INFO] 2018-11-14T16:37:25z src/he_backend.cpp 447	Reshape_7 took 0s
[INFO] 2018-11-14T16:37:25z src/he_backend.cpp 351	[ Multiply_8 ]
[INFO] 2018-11-14T16:37:31z src/he_backend.cpp 447	Multiply_8 took 5s
[INFO] 2018-11-14T16:37:31z src/he_backend.cpp 351	[ Pad_11 ]
[INFO] 2018-11-14T16:37:31z src/kernel/pad.cpp 46	Pad cipher ciper
[INFO] 2018-11-14T16:37:31z src/he_backend.cpp 447	Pad_11 took 0s
[INFO] 2018-11-14T16:37:31z src/he_backend.cpp 351	[ Reshape_13 ]
[INFO] 2018-11-14T16:37:31z src/he_backend.cpp 447	Reshape_13 took 0s
[INFO] 2018-11-14T16:37:31z src/he_backend.cpp 351	[ Dot_15 ]
[INFO] 2018-11-14T16:37:31z src/he_backend.cpp 681	1x845 dot 845x100
[INFO] 2018-11-14T16:37:31z src/he_backend.cpp 698	Dot cipher plain => cipher
 [INFO] 2018-11-14T16:37:55z src/he_backend.cpp 447	Dot_15 took 24s
[INFO] 2018-11-14T16:37:55z src/he_backend.cpp 351	[ Multiply_16 ]
[INFO] 2018-11-14T16:37:55z src/he_backend.cpp 447	Multiply_16 took 0s
[INFO] 2018-11-14T16:37:55z src/he_backend.cpp 351	[ Dot_18 ]
[INFO] 2018-11-14T16:37:55z src/he_backend.cpp 681	1x100 dot 100x10
[INFO] 2018-11-14T16:37:55z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:37:55z src/he_backend.cpp 447	Dot_18 took 0s
[INFO] 2018-11-14T16:37:55z src/he_backend.cpp 351	[ Result_19 ]
[INFO] 2018-11-14T16:37:55z src/he_backend.cpp 447	Result_19 took 0s
2018-11-14 08:37:55.825933: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 0
2018-11-14 08:37:56.122812: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 0
total time warmup 40.32753920555115
starting timer 1
2018-11-14 08:37:56.138543: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-14 08:37:56.138576: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-14 08:37:56.138591: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-14 08:37:56.138611: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-14 08:37:56.138628: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-14 08:37:56.138642: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-14 08:37:56.138657: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-14 08:37:56.138669: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-14 08:37:56.138683: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-14 08:37:56.138701: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-14 08:37:56.138722: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-14 08:37:56.138735: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-14 08:37:56.138749: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-14 08:37:56.138762: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-14 08:37:56.138773: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-14 08:37:56.138784: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-14 08:37:56.138793: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/MatMul_0_0
2018-11-14 08:37:56.138808: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:37:56.138863: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-14 08:37:56.138884: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-14 08:37:56.138896: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-14 08:37:56.138910: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-14 08:37:56.138922: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-14 08:37:56.138934: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-14 08:37:56.138945: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-14 08:37:56.138958: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-14 08:37:56.138970: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-14 08:37:56.138981: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-14 08:37:56.138992: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-14 08:37:56.139004: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-14 08:37:56.139015: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-14 08:37:56.139026: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-14 08:37:56.139037: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for _arg_Placeholder_0_0[_Arg]
2018-11-14 08:37:56.139048: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:37:56.139132: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-14 08:37:56.139158: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-14 08:37:56.139180: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-14 08:37:56.139198: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-14 08:37:56.139217: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-14 08:37:56.139239: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-14 08:37:56.139257: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-14 08:37:56.139283: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-14 08:37:56.139301: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-14 08:37:56.139330: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-14 08:37:56.139348: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-14 08:37:56.139374: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-14 08:37:56.139395: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-14 08:37:56.139413: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-14 08:37:56.139439: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:37:56.139450: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:37:56.139479: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:37:56.139490: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:37:56.139498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-14 08:37:56.139506: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-14 08:37:56.139526: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d7720 :: reshape/Reshape/shape [Const]
2018-11-14 08:37:56.139536: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d7798 :: conv1/Const [Const]
2018-11-14 08:37:56.139546: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d7810 :: conv1/pad_const [Const]
2018-11-14 08:37:56.139555: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d7888 :: fc1/Reshape/shape [Const]
2018-11-14 08:37:56.139565: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d7900 :: squash/Const [Const]
2018-11-14 08:37:56.139575: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d7978 :: fc2/Const [Const]
2018-11-14 08:37:56.139597: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d79f0 :: reshape/Reshape [Reshape]
2018-11-14 08:37:56.139606: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d7aa8 :: conv1/Conv2D [Conv2D]
2018-11-14 08:37:56.139615: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d7b60 :: conv1/Square [Square]
2018-11-14 08:37:56.139624: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d7bf8 :: conv1/Pad [Pad]
2018-11-14 08:37:56.139632: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d7cb0 :: fc1/Reshape [Reshape]
2018-11-14 08:37:56.139641: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d7d68 :: fc1/MatMul [MatMul]
2018-11-14 08:37:56.139650: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d7e20 :: fc1/Square [Square]
2018-11-14 08:37:56.139658: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x66d7eb8 :: fc2/MatMul [MatMul]
2018-11-14 08:37:56.139732: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-14 08:37:56.139782: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 1 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-14 08:37:56.139818: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 1, datatype: 1
2018-11-14 08:37:56.139861: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 1 to _retval_fc2/MatMul_0_0[0] in -1, datatype: 1
2018-11-14 08:37:56.140849: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-14 08:37:56.140869: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-14T16:37:57z src/seal/he_seal_util.hpp 45
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
[INFO] 2018-11-14T16:37:57z src/seal/ckks/he_seal_ckks_backend.cpp 115	Creating backend
2018-11-14 08:37:57.275270: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 1
2018-11-14 08:37:57.275301: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-14 08:37:57.275310: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 1
2018-11-14 08:37:57.275317: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_1
2018-11-14 08:37:57.275394: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-14 08:37:57.275454: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-14 08:37:57.275475: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-14 08:37:57.275496: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-14 08:37:57.275532: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-14 08:37:57.275579: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-14 08:37:57.275596: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-14 08:37:57.275603: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-14 08:37:57.275609: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-14 08:37:57.275615: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-14 08:37:57.275627: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-14 08:37:57.275656: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-14 08:37:57.275664: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-14 08:37:57.275671: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-14 08:37:57.275680: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-14 08:37:57.275706: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-14 08:37:57.275718: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-14 08:37:57.275725: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-14 08:37:57.275821: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-14 08:37:57.275853: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-14 08:37:57.275897: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-14 08:37:57.275929: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-14 08:37:57.275954: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-14 08:37:57.275963: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-14 08:37:57.275970: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-14 08:37:57.276022: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-14 08:37:57.276051: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-14 08:37:57.276065: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-14 08:37:57.276079: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-14 08:37:57.276111: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-14 08:37:57.276723: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-14 08:37:57.276775: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-14 08:37:57.276814: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-14 08:37:57.276858: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-14 08:37:57.276984: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 1
2018-11-14 08:37:57.277002: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 1
[INFO] 2018-11-14T16:37:57z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:37:57z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 784
2018-11-14 08:37:57.581474: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 1
[INFO] 2018-11-14T16:37:57z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:37:57z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 10
2018-11-14 08:37:57.608379: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 1
2018-11-14 08:37:57.608429: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 1
[INFO] 2018-11-14T16:37:57z src/he_backend.cpp 351	[ Parameter_20 ]
[INFO] 2018-11-14T16:37:57z src/he_backend.cpp 351	[ Constant_37 ]
[INFO] 2018-11-14T16:37:57z src/he_backend.cpp 447	Constant_37 took 0s
[INFO] 2018-11-14T16:37:57z src/he_backend.cpp 351	[ Constant_34 ]
[INFO] 2018-11-14T16:37:59z src/he_backend.cpp 447	Constant_34 took 1s
[INFO] 2018-11-14T16:37:59z src/he_backend.cpp 351	[ Constant_30 ]
[INFO] 2018-11-14T16:37:59z src/he_backend.cpp 447	Constant_30 took 0s
[INFO] 2018-11-14T16:37:59z src/he_backend.cpp 351	[ Constant_23 ]
[INFO] 2018-11-14T16:37:59z src/he_backend.cpp 447	Constant_23 took 0s
[INFO] 2018-11-14T16:37:59z src/he_backend.cpp 351	[ Reshape_22 ]
[INFO] 2018-11-14T16:37:59z src/he_backend.cpp 447	Reshape_22 took 0s
[INFO] 2018-11-14T16:37:59z src/he_backend.cpp 351	[ Reshape_25 ]
[INFO] 2018-11-14T16:37:59z src/he_backend.cpp 447	Reshape_25 took 0s
[INFO] 2018-11-14T16:37:59z src/he_backend.cpp 351	[ Reshape_24 ]
[INFO] 2018-11-14T16:37:59z src/he_backend.cpp 447	Reshape_24 took 0s
[INFO] 2018-11-14T16:37:59z src/he_backend.cpp 351	[ Convolution_26 ]
[INFO] 2018-11-14T16:37:59z src/kernel/convolution.hpp 107	out_transform_size 720
[INFO] 2018-11-14T16:38:05z src/he_backend.cpp 447	Convolution_26 took 5s
[INFO] 2018-11-14T16:38:05z src/he_backend.cpp 351	[ Reshape_27 ]
[INFO] 2018-11-14T16:38:05z src/he_backend.cpp 447	Reshape_27 took 0s
[INFO] 2018-11-14T16:38:05z src/he_backend.cpp 351	[ Multiply_28 ]
[INFO] 2018-11-14T16:38:05z src/he_backend.cpp 447	Multiply_28 took 0s
[INFO] 2018-11-14T16:38:05z src/he_backend.cpp 351	[ Pad_31 ]
[INFO] 2018-11-14T16:38:06z src/kernel/pad.cpp 46	Pad cipher ciper
[INFO] 2018-11-14T16:38:06z src/he_backend.cpp 447	Pad_31 took 0s
[INFO] 2018-11-14T16:38:06z src/he_backend.cpp 351	[ Reshape_33 ]
[INFO] 2018-11-14T16:38:06z src/he_backend.cpp 447	Reshape_33 took 0s
[INFO] 2018-11-14T16:38:06z src/he_backend.cpp 351	[ Dot_35 ]
[INFO] 2018-11-14T16:38:06z src/he_backend.cpp 681	1x845 dot 845x100
[INFO] 2018-11-14T16:38:06z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:38:22z src/he_backend.cpp 447	Dot_35 took 16s
[INFO] 2018-11-14T16:38:22z src/he_backend.cpp 351	[ Multiply_36 ]
[INFO] 2018-11-14T16:38:22z src/he_backend.cpp 447	Multiply_36 took 0s
[INFO] 2018-11-14T16:38:22z src/he_backend.cpp 351	[ Dot_38 ]
[INFO] 2018-11-14T16:38:22z src/he_backend.cpp 681	1x100 dot 100x10
[INFO] 2018-11-14T16:38:22z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:38:22z src/he_backend.cpp 447	Dot_38 took 0s
[INFO] 2018-11-14T16:38:22z src/he_backend.cpp 351	[ Result_39 ]
[INFO] 2018-11-14T16:38:22z src/he_backend.cpp 447	Result_39 took 0s
2018-11-14 08:38:22.962042: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 1
2018-11-14 08:38:23.144415: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 1
total time 1: 27.01756262779236
starting timer 2
2018-11-14 08:38:23.154987: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-14 08:38:23.155015: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-14 08:38:23.155027: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-14 08:38:23.155038: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-14 08:38:23.155047: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-14 08:38:23.155057: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-14 08:38:23.155069: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-14 08:38:23.155080: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-14 08:38:23.155090: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-14 08:38:23.155102: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-14 08:38:23.155113: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-14 08:38:23.155123: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-14 08:38:23.155133: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-14 08:38:23.155142: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-14 08:38:23.155151: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-14 08:38:23.155158: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-14 08:38:23.155165: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/MatMul_0_0
2018-11-14 08:38:23.155172: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:38:23.155220: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-14 08:38:23.155237: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-14 08:38:23.155246: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-14 08:38:23.155255: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-14 08:38:23.155265: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-14 08:38:23.155275: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-14 08:38:23.155284: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-14 08:38:23.155293: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-14 08:38:23.155303: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-14 08:38:23.155312: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-14 08:38:23.155321: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-14 08:38:23.155331: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-14 08:38:23.155340: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-14 08:38:23.155349: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-14 08:38:23.155358: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for _arg_Placeholder_0_0[_Arg]
2018-11-14 08:38:23.155368: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:38:23.155437: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-14 08:38:23.155459: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-14 08:38:23.155477: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-14 08:38:23.155492: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-14 08:38:23.155508: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-14 08:38:23.155526: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-14 08:38:23.155541: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-14 08:38:23.155563: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-14 08:38:23.155577: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-14 08:38:23.155601: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-14 08:38:23.155616: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-14 08:38:23.155638: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-14 08:38:23.155655: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-14 08:38:23.155670: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-14 08:38:23.155692: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:38:23.155702: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:38:23.155726: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:38:23.155735: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:38:23.155742: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-14 08:38:23.155748: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-14 08:38:23.155764: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66edb70 :: reshape/Reshape/shape [Const]
2018-11-14 08:38:23.155773: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66edbe8 :: conv1/Const [Const]
2018-11-14 08:38:23.155780: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66edc60 :: conv1/pad_const [Const]
2018-11-14 08:38:23.155788: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66edcd8 :: fc1/Reshape/shape [Const]
2018-11-14 08:38:23.155795: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66edd50 :: squash/Const [Const]
2018-11-14 08:38:23.155803: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66eddc8 :: fc2/Const [Const]
2018-11-14 08:38:23.155810: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66ede40 :: reshape/Reshape [Reshape]
2018-11-14 08:38:23.155818: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66edef8 :: conv1/Conv2D [Conv2D]
2018-11-14 08:38:23.155825: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66edfb0 :: conv1/Square [Square]
2018-11-14 08:38:23.155833: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66ee048 :: conv1/Pad [Pad]
2018-11-14 08:38:23.155840: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66ee100 :: fc1/Reshape [Reshape]
2018-11-14 08:38:23.155848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66ee1b8 :: fc1/MatMul [MatMul]
2018-11-14 08:38:23.155855: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66ee270 :: fc1/Square [Square]
2018-11-14 08:38:23.155863: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x66ee308 :: fc2/MatMul [MatMul]
2018-11-14 08:38:23.155929: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-14 08:38:23.155976: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 2 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-14 08:38:23.156009: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 2, datatype: 1
2018-11-14 08:38:23.156048: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 2 to _retval_fc2/MatMul_0_0[0] in -1, datatype: 1
2018-11-14 08:38:23.156735: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-14 08:38:23.156754: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-14T16:38:24z src/seal/he_seal_util.hpp 45
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
[INFO] 2018-11-14T16:38:24z src/seal/ckks/he_seal_ckks_backend.cpp 115	Creating backend
2018-11-14 08:38:24.300810: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 2
2018-11-14 08:38:24.300911: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-14 08:38:24.300942: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 2
2018-11-14 08:38:24.300966: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_2
2018-11-14 08:38:24.301172: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-14 08:38:24.301260: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-14 08:38:24.301285: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-14 08:38:24.301314: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-14 08:38:24.301357: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-14 08:38:24.301409: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-14 08:38:24.301429: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-14 08:38:24.301437: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-14 08:38:24.301443: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-14 08:38:24.301449: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-14 08:38:24.301461: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-14 08:38:24.301493: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-14 08:38:24.301501: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-14 08:38:24.301507: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-14 08:38:24.301516: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-14 08:38:24.301543: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-14 08:38:24.301556: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-14 08:38:24.301563: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-14 08:38:24.301662: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-14 08:38:24.301696: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-14 08:38:24.301744: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-14 08:38:24.301781: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-14 08:38:24.301807: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-14 08:38:24.301816: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-14 08:38:24.301823: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-14 08:38:24.301881: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-14 08:38:24.301912: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-14 08:38:24.301926: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-14 08:38:24.301939: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-14 08:38:24.301973: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-14 08:38:24.302670: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-14 08:38:24.302722: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-14 08:38:24.302759: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-14 08:38:24.302807: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-14 08:38:24.302936: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 2
2018-11-14 08:38:24.302957: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 2
[INFO] 2018-11-14T16:38:24z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:38:24z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 784
2018-11-14 08:38:24.499869: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 2
[INFO] 2018-11-14T16:38:24z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:38:24z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 10
2018-11-14 08:38:24.528383: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 2
2018-11-14 08:38:24.528409: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 2
[INFO] 2018-11-14T16:38:24z src/he_backend.cpp 351	[ Parameter_40 ]
[INFO] 2018-11-14T16:38:24z src/he_backend.cpp 351	[ Constant_57 ]
[INFO] 2018-11-14T16:38:24z src/he_backend.cpp 447	Constant_57 took 0s
[INFO] 2018-11-14T16:38:24z src/he_backend.cpp 351	[ Constant_54 ]
[INFO] 2018-11-14T16:38:25z src/he_backend.cpp 447	Constant_54 took 1s
[INFO] 2018-11-14T16:38:25z src/he_backend.cpp 351	[ Constant_50 ]
[INFO] 2018-11-14T16:38:25z src/he_backend.cpp 447	Constant_50 took 0s
[INFO] 2018-11-14T16:38:25z src/he_backend.cpp 351	[ Constant_43 ]
[INFO] 2018-11-14T16:38:26z src/he_backend.cpp 447	Constant_43 took 0s
[INFO] 2018-11-14T16:38:26z src/he_backend.cpp 351	[ Reshape_42 ]
[INFO] 2018-11-14T16:38:26z src/he_backend.cpp 447	Reshape_42 took 0s
[INFO] 2018-11-14T16:38:26z src/he_backend.cpp 351	[ Reshape_45 ]
[INFO] 2018-11-14T16:38:26z src/he_backend.cpp 447	Reshape_45 took 0s
[INFO] 2018-11-14T16:38:26z src/he_backend.cpp 351	[ Reshape_44 ]
[INFO] 2018-11-14T16:38:26z src/he_backend.cpp 447	Reshape_44 took 0s
[INFO] 2018-11-14T16:38:26z src/he_backend.cpp 351	[ Convolution_46 ]
[INFO] 2018-11-14T16:38:26z src/kernel/convolution.hpp 107	out_transform_size 720
[INFO] 2018-11-14T16:38:31z src/he_backend.cpp 447	Convolution_46 took 5s
[INFO] 2018-11-14T16:38:31z src/he_backend.cpp 351	[ Reshape_47 ]
[INFO] 2018-11-14T16:38:31z src/he_backend.cpp 447	Reshape_47 took 0s
[INFO] 2018-11-14T16:38:31z src/he_backend.cpp 351	[ Multiply_48 ]
[INFO] 2018-11-14T16:38:31z src/he_backend.cpp 447	Multiply_48 took 0s
[INFO] 2018-11-14T16:38:31z src/he_backend.cpp 351	[ Pad_51 ]
[INFO] 2018-11-14T16:38:31z src/kernel/pad.cpp 46	Pad cipher ciper
[INFO] 2018-11-14T16:38:31z src/he_backend.cpp 447	Pad_51 took 0s
[INFO] 2018-11-14T16:38:31z src/he_backend.cpp 351	[ Reshape_53 ]
[INFO] 2018-11-14T16:38:31z src/he_backend.cpp 447	Reshape_53 took 0s
[INFO] 2018-11-14T16:38:31z src/he_backend.cpp 351	[ Dot_55 ]
[INFO] 2018-11-14T16:38:31z src/he_backend.cpp 681	1x845 dot 845x100
[INFO] 2018-11-14T16:38:31z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:38:48z src/he_backend.cpp 447	Dot_55 took 16s
[INFO] 2018-11-14T16:38:48z src/he_backend.cpp 351	[ Multiply_56 ]
[INFO] 2018-11-14T16:38:48z src/he_backend.cpp 447	Multiply_56 took 0s
[INFO] 2018-11-14T16:38:48z src/he_backend.cpp 351	[ Dot_58 ]
[INFO] 2018-11-14T16:38:48z src/he_backend.cpp 681	1x100 dot 100x10
[INFO] 2018-11-14T16:38:48z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:38:48z src/he_backend.cpp 447	Dot_58 took 0s
[INFO] 2018-11-14T16:38:48z src/he_backend.cpp 351	[ Result_59 ]
[INFO] 2018-11-14T16:38:48z src/he_backend.cpp 447	Result_59 took 0s
2018-11-14 08:38:48.600085: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 2
2018-11-14 08:38:48.784205: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 2
total time 2: 25.636876583099365
starting timer 3
2018-11-14 08:38:48.795075: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-14 08:38:48.795125: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-14 08:38:48.795156: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-14 08:38:48.795173: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-14 08:38:48.795188: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-14 08:38:48.795205: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-14 08:38:48.795223: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-14 08:38:48.795239: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-14 08:38:48.795255: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-14 08:38:48.795274: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-14 08:38:48.795290: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-14 08:38:48.795307: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-14 08:38:48.795324: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-14 08:38:48.795340: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-14 08:38:48.795354: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-14 08:38:48.795365: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-14 08:38:48.795378: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/MatMul_0_0
2018-11-14 08:38:48.795389: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:38:48.795458: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-14 08:38:48.795482: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-14 08:38:48.795497: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-14 08:38:48.795512: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-14 08:38:48.795528: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-14 08:38:48.795543: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-14 08:38:48.795558: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-14 08:38:48.795572: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-14 08:38:48.795588: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-14 08:38:48.795602: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-14 08:38:48.795617: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-14 08:38:48.795631: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-14 08:38:48.795646: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-14 08:38:48.795661: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-14 08:38:48.795676: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for _arg_Placeholder_0_0[_Arg]
2018-11-14 08:38:48.795691: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:38:48.795796: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-14 08:38:48.795830: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-14 08:38:48.795856: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-14 08:38:48.795878: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-14 08:38:48.795902: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-14 08:38:48.795928: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-14 08:38:48.795950: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-14 08:38:48.795981: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-14 08:38:48.796003: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-14 08:38:48.796037: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-14 08:38:48.796059: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-14 08:38:48.796090: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-14 08:38:48.796115: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-14 08:38:48.796137: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-14 08:38:48.796167: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:38:48.796182: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:38:48.796216: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:38:48.796230: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:38:48.796242: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-14 08:38:48.796251: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-14 08:38:48.796273: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb0e0 :: reshape/Reshape/shape [Const]
2018-11-14 08:38:48.796287: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb158 :: conv1/Const [Const]
2018-11-14 08:38:48.796300: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb1d0 :: conv1/pad_const [Const]
2018-11-14 08:38:48.796313: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb248 :: fc1/Reshape/shape [Const]
2018-11-14 08:38:48.796325: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb2c0 :: squash/Const [Const]
2018-11-14 08:38:48.796338: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb338 :: fc2/Const [Const]
2018-11-14 08:38:48.796351: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb3b0 :: reshape/Reshape [Reshape]
2018-11-14 08:38:48.796389: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb468 :: conv1/Conv2D [Conv2D]
2018-11-14 08:38:48.796402: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb520 :: conv1/Square [Square]
2018-11-14 08:38:48.796415: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb5b8 :: conv1/Pad [Pad]
2018-11-14 08:38:48.796428: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb670 :: fc1/Reshape [Reshape]
2018-11-14 08:38:48.796441: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb728 :: fc1/MatMul [MatMul]
2018-11-14 08:38:48.796454: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb7e0 :: fc1/Square [Square]
2018-11-14 08:38:48.796466: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x66eb878 :: fc2/MatMul [MatMul]
2018-11-14 08:38:48.796552: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-14 08:38:48.796620: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 3 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-14 08:38:48.796667: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 3, datatype: 1
2018-11-14 08:38:48.796726: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 3 to _retval_fc2/MatMul_0_0[0] in -1, datatype: 1
2018-11-14 08:38:48.797678: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-14 08:38:48.797704: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-14T16:38:49z src/seal/he_seal_util.hpp 45
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
[INFO] 2018-11-14T16:38:49z src/seal/ckks/he_seal_ckks_backend.cpp 115	Creating backend
2018-11-14 08:38:49.866116: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 3
2018-11-14 08:38:49.866158: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-14 08:38:49.866170: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 3
2018-11-14 08:38:49.866177: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_3
2018-11-14 08:38:49.866254: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-14 08:38:49.866325: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-14 08:38:49.866347: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-14 08:38:49.866368: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-14 08:38:49.866406: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-14 08:38:49.866454: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-14 08:38:49.866471: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-14 08:38:49.866479: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-14 08:38:49.866485: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-14 08:38:49.866490: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-14 08:38:49.866502: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-14 08:38:49.866536: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-14 08:38:49.866544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-14 08:38:49.866551: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-14 08:38:49.866560: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-14 08:38:49.866586: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-14 08:38:49.866598: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-14 08:38:49.866605: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-14 08:38:49.866706: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-14 08:38:49.866739: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-14 08:38:49.866785: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-14 08:38:49.866818: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-14 08:38:49.866845: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-14 08:38:49.866855: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-14 08:38:49.866861: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-14 08:38:49.866914: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-14 08:38:49.866944: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-14 08:38:49.866957: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-14 08:38:49.866971: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-14 08:38:49.867006: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-14 08:38:49.867765: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-14 08:38:49.867811: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-14 08:38:49.867848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-14 08:38:49.867887: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-14 08:38:49.868008: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 3
2018-11-14 08:38:49.868027: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 3
[INFO] 2018-11-14T16:38:49z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:38:49z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 784
2018-11-14 08:38:50.103914: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 3
[INFO] 2018-11-14T16:38:50z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:38:50z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 10
2018-11-14 08:38:50.104322: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 3
2018-11-14 08:38:50.104336: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 3
[INFO] 2018-11-14T16:38:50z src/he_backend.cpp 351	[ Parameter_60 ]
[INFO] 2018-11-14T16:38:50z src/he_backend.cpp 351	[ Constant_77 ]
[INFO] 2018-11-14T16:38:50z src/he_backend.cpp 447	Constant_77 took 0s
[INFO] 2018-11-14T16:38:50z src/he_backend.cpp 351	[ Constant_74 ]
[INFO] 2018-11-14T16:38:52z src/he_backend.cpp 447	Constant_74 took 2s
[INFO] 2018-11-14T16:38:52z src/he_backend.cpp 351	[ Constant_70 ]
[INFO] 2018-11-14T16:38:52z src/he_backend.cpp 447	Constant_70 took 0s
[INFO] 2018-11-14T16:38:52z src/he_backend.cpp 351	[ Constant_63 ]
[INFO] 2018-11-14T16:38:52z src/he_backend.cpp 447	Constant_63 took 0s
[INFO] 2018-11-14T16:38:52z src/he_backend.cpp 351	[ Reshape_62 ]
[INFO] 2018-11-14T16:38:52z src/he_backend.cpp 447	Reshape_62 took 0s
[INFO] 2018-11-14T16:38:52z src/he_backend.cpp 351	[ Reshape_65 ]
[INFO] 2018-11-14T16:38:52z src/he_backend.cpp 447	Reshape_65 took 0s
[INFO] 2018-11-14T16:38:52z src/he_backend.cpp 351	[ Reshape_64 ]
[INFO] 2018-11-14T16:38:52z src/he_backend.cpp 447	Reshape_64 took 0s
[INFO] 2018-11-14T16:38:52z src/he_backend.cpp 351	[ Convolution_66 ]
[INFO] 2018-11-14T16:38:52z src/kernel/convolution.hpp 107	out_transform_size 720
37[INFO] 2018-11-14T16:38:57z src/he_backend.cpp 447	Convolution_66 took 5s
[INFO] 2018-11-14T16:38:57z src/he_backend.cpp 351	[ Reshape_67 ]
[INFO] 2018-11-14T16:38:57z src/he_backend.cpp 447	Reshape_67 took 0s
[INFO] 2018-11-14T16:38:57z src/he_backend.cpp 351	[ Multiply_68 ]
[INFO] 2018-11-14T16:38:58z src/he_backend.cpp 447	Multiply_68 took 0s
[INFO] 2018-11-14T16:38:58z src/he_backend.cpp 351	[ Pad_71 ]
[INFO] 2018-11-14T16:38:58z src/kernel/pad.cpp 46	Pad cipher ciper
[INFO] 2018-11-14T16:38:58z src/he_backend.cpp 447	Pad_71 took 0s
[INFO] 2018-11-14T16:38:58z src/he_backend.cpp 351	[ Reshape_73 ]
[INFO] 2018-11-14T16:38:58z src/he_backend.cpp 447	Reshape_73 took 0s
[INFO] 2018-11-14T16:38:58z src/he_backend.cpp 351	[ Dot_75 ]
[INFO] 2018-11-14T16:38:58z src/he_backend.cpp 681	1x845 dot 845x100
[INFO] 2018-11-14T16:38:58z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:39:14z src/he_backend.cpp 447	Dot_75 took 16s
[INFO] 2018-11-14T16:39:14z src/he_backend.cpp 351	[ Multiply_76 ]
[INFO] 2018-11-14T16:39:14z src/he_backend.cpp 447	Multiply_76 took 0s
[INFO] 2018-11-14T16:39:14z src/he_backend.cpp 351	[ Dot_78 ]
[INFO] 2018-11-14T16:39:14z src/he_backend.cpp 681	1x100 dot 100x10
[INFO] 2018-11-14T16:39:14z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:39:15z src/he_backend.cpp 447	Dot_78 took 0s
[INFO] 2018-11-14T16:39:15z src/he_backend.cpp 351	[ Result_79 ]
[INFO] 2018-11-14T16:39:15z src/he_backend.cpp 447	Result_79 took 0s
2018-11-14 08:39:15.293230: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 3
2018-11-14 08:39:15.604842: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 3
total time 3: 26.816718101501465
starting timer 4
2018-11-14 08:39:15.613560: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-14 08:39:15.613602: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-14 08:39:15.613613: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-14 08:39:15.613622: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-14 08:39:15.613631: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-14 08:39:15.613642: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-14 08:39:15.613656: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-14 08:39:15.613665: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-14 08:39:15.613678: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-14 08:39:15.613691: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-14 08:39:15.613701: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-14 08:39:15.613712: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-14 08:39:15.613722: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-14 08:39:15.613732: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-14 08:39:15.613741: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-14 08:39:15.613747: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-14 08:39:15.613755: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/MatMul_0_0
2018-11-14 08:39:15.613761: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:39:15.613826: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-14 08:39:15.613847: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-14 08:39:15.613856: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-14 08:39:15.613864: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-14 08:39:15.613874: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-14 08:39:15.613883: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-14 08:39:15.613892: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-14 08:39:15.613900: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-14 08:39:15.613909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-14 08:39:15.613918: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-14 08:39:15.613927: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-14 08:39:15.613935: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-14 08:39:15.613944: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-14 08:39:15.613952: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-14 08:39:15.613961: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for _arg_Placeholder_0_0[_Arg]
2018-11-14 08:39:15.613970: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:39:15.614048: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-14 08:39:15.614074: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-14 08:39:15.614092: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-14 08:39:15.614107: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-14 08:39:15.614121: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-14 08:39:15.614139: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-14 08:39:15.614153: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-14 08:39:15.614173: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-14 08:39:15.614187: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-14 08:39:15.614210: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-14 08:39:15.614224: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-14 08:39:15.614245: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-14 08:39:15.614261: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-14 08:39:15.614275: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-14 08:39:15.614296: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:39:15.614306: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:39:15.614328: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:39:15.614337: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:39:15.614343: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-14 08:39:15.614349: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-14 08:39:15.614366: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x6973230 :: reshape/Reshape/shape [Const]
2018-11-14 08:39:15.614375: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x69732a8 :: conv1/Const [Const]
2018-11-14 08:39:15.614382: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x6973320 :: conv1/pad_const [Const]
2018-11-14 08:39:15.614389: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x6973398 :: fc1/Reshape/shape [Const]
2018-11-14 08:39:15.614397: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x6973410 :: squash/Const [Const]
2018-11-14 08:39:15.614404: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x6973488 :: fc2/Const [Const]
2018-11-14 08:39:15.614411: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x6973500 :: reshape/Reshape [Reshape]
2018-11-14 08:39:15.614418: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x69735b8 :: conv1/Conv2D [Conv2D]
2018-11-14 08:39:15.614425: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x6973670 :: conv1/Square [Square]
2018-11-14 08:39:15.614433: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x6973708 :: conv1/Pad [Pad]
2018-11-14 08:39:15.614440: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x69737c0 :: fc1/Reshape [Reshape]
2018-11-14 08:39:15.614447: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x6973878 :: fc1/MatMul [MatMul]
2018-11-14 08:39:15.614454: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x6973930 :: fc1/Square [Square]
2018-11-14 08:39:15.614461: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x69739c8 :: fc2/MatMul [MatMul]
2018-11-14 08:39:15.614525: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-14 08:39:15.614574: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 4 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-14 08:39:15.614609: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 4, datatype: 1
2018-11-14 08:39:15.614658: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 4 to _retval_fc2/MatMul_0_0[0] in -1, datatype: 1
2018-11-14 08:39:15.616195: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-14 08:39:15.616216: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-14T16:39:16z src/seal/he_seal_util.hpp 45
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
[INFO] 2018-11-14T16:39:16z src/seal/ckks/he_seal_ckks_backend.cpp 115	Creating backend
2018-11-14 08:39:16.685843: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 4
2018-11-14 08:39:16.685945: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-14 08:39:16.685988: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 4
2018-11-14 08:39:16.685996: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_4
2018-11-14 08:39:16.686066: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-14 08:39:16.686132: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-14 08:39:16.686154: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-14 08:39:16.686176: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-14 08:39:16.686213: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-14 08:39:16.686262: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-14 08:39:16.686280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-14 08:39:16.686288: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-14 08:39:16.686294: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-14 08:39:16.686300: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-14 08:39:16.686311: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-14 08:39:16.686342: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-14 08:39:16.686350: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-14 08:39:16.686357: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-14 08:39:16.686366: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-14 08:39:16.686400: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-14 08:39:16.686414: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-14 08:39:16.686421: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-14 08:39:16.686517: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-14 08:39:16.686551: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-14 08:39:16.686598: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-14 08:39:16.686632: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-14 08:39:16.686657: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-14 08:39:16.686666: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-14 08:39:16.686673: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-14 08:39:16.686728: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-14 08:39:16.686758: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-14 08:39:16.686772: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-14 08:39:16.686785: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-14 08:39:16.686818: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-14 08:39:16.687861: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-14 08:39:16.687914: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-14 08:39:16.687952: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-14 08:39:16.688008: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-14 08:39:16.688139: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 4
2018-11-14 08:39:16.688158: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 4
[INFO] 2018-11-14T16:39:16z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:39:16z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 784
2018-11-14 08:39:16.829820: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 4
[INFO] 2018-11-14T16:39:16z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:39:16z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 10
2018-11-14 08:39:16.830671: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 4
2018-11-14 08:39:16.830686: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 4
[INFO] 2018-11-14T16:39:16z src/he_backend.cpp 351	[ Parameter_80 ]
[INFO] 2018-11-14T16:39:16z src/he_backend.cpp 351	[ Constant_97 ]
[INFO] 2018-11-14T16:39:16z src/he_backend.cpp 447	Constant_97 took 0s
[INFO] 2018-11-14T16:39:16z src/he_backend.cpp 351	[ Constant_94 ]
[INFO] 2018-11-14T16:39:18z src/he_backend.cpp 447	Constant_94 took 1s
[INFO] 2018-11-14T16:39:18z src/he_backend.cpp 351	[ Constant_90 ]
[INFO] 2018-11-14T16:39:18z src/he_backend.cpp 447	Constant_90 took 0s
[INFO] 2018-11-14T16:39:18z src/he_backend.cpp 351	[ Constant_83 ]
[INFO] 2018-11-14T16:39:18z src/he_backend.cpp 447	Constant_83 took 0s
[INFO] 2018-11-14T16:39:18z src/he_backend.cpp 351	[ Reshape_82 ]
[INFO] 2018-11-14T16:39:18z src/he_backend.cpp 447	Reshape_82 took 0s
[INFO] 2018-11-14T16:39:18z src/he_backend.cpp 351	[ Reshape_85 ]
[INFO] 2018-11-14T16:39:18z src/he_backend.cpp 447	Reshape_85 took 0s
[INFO] 2018-11-14T16:39:18z src/he_backend.cpp 351	[ Reshape_84 ]
[INFO] 2018-11-14T16:39:18z src/he_backend.cpp 447	Reshape_84 took 0s
[INFO] 2018-11-14T16:39:18z src/he_backend.cpp 351	[ Convolution_86 ]
[INFO] 2018-11-14T16:39:18z src/kernel/convolution.hpp 107	out_transform_size 720
[INFO] 2018-11-14T16:39:23z src/he_backend.cpp 447	Convolution_86 took 5s
[INFO] 2018-11-14T16:39:23z src/he_backend.cpp 351	[ Reshape_87 ]
[INFO] 2018-11-14T16:39:23z src/he_backend.cpp 447	Reshape_87 took 0s
[INFO] 2018-11-14T16:39:23z src/he_backend.cpp 351	[ Multiply_88 ]
[INFO] 2018-11-14T16:39:23z src/he_backend.cpp 447	Multiply_88 took 0s
[INFO] 2018-11-14T16:39:23z src/he_backend.cpp 351	[ Pad_91 ]
[INFO] 2018-11-14T16:39:23z src/kernel/pad.cpp 46	Pad cipher ciper
[INFO] 2018-11-14T16:39:23z src/he_backend.cpp 447	Pad_91 took 0s
[INFO] 2018-11-14T16:39:23z src/he_backend.cpp 351	[ Reshape_93 ]
[INFO] 2018-11-14T16:39:23z src/he_backend.cpp 447	Reshape_93 took 0s
[INFO] 2018-11-14T16:39:23z src/he_backend.cpp 351	[ Dot_95 ]
[INFO] 2018-11-14T16:39:23z src/he_backend.cpp 681	1x845 dot 845x100
[INFO] 2018-11-14T16:39:23z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:39:40z src/he_backend.cpp 447	Dot_95 took 16s
[INFO] 2018-11-14T16:39:40z src/he_backend.cpp 351	[ Multiply_96 ]
[INFO] 2018-11-14T16:39:40z src/he_backend.cpp 447	Multiply_96 took 0s
[INFO] 2018-11-14T16:39:40z src/he_backend.cpp 351	[ Dot_98 ]
[INFO] 2018-11-14T16:39:40z src/he_backend.cpp 681	1x100 dot 100x10
[INFO] 2018-11-14T16:39:40z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:39:40z src/he_backend.cpp 447	Dot_98 took 0s
[INFO] 2018-11-14T16:39:40z src/he_backend.cpp 351	[ Result_99 ]
[INFO] 2018-11-14T16:39:40z src/he_backend.cpp 447	Result_99 took 0s
2018-11-14 08:39:40.425691: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 4
2018-11-14 08:39:40.653190: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 4
total time 4: 25.046579837799072
starting timer 5
2018-11-14 08:39:40.663119: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-14 08:39:40.663162: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-14 08:39:40.663172: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-14 08:39:40.663181: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-14 08:39:40.663189: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-14 08:39:40.663196: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-14 08:39:40.663220: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-14 08:39:40.663230: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-14 08:39:40.663259: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-14 08:39:40.663272: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-14 08:39:40.663283: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-14 08:39:40.663294: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-14 08:39:40.663303: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-14 08:39:40.663312: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-14 08:39:40.663321: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-14 08:39:40.663328: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-14 08:39:40.663335: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/MatMul_0_0
2018-11-14 08:39:40.663341: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:39:40.663392: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-14 08:39:40.663410: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-14 08:39:40.663419: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-14 08:39:40.663427: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-14 08:39:40.663437: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-14 08:39:40.663445: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-14 08:39:40.663454: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-14 08:39:40.663463: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-14 08:39:40.663472: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-14 08:39:40.663481: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-14 08:39:40.663489: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-14 08:39:40.663498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-14 08:39:40.663506: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-14 08:39:40.663515: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-14 08:39:40.663523: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for _arg_Placeholder_0_0[_Arg]
2018-11-14 08:39:40.663532: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:39:40.663604: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-14 08:39:40.663627: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-14 08:39:40.663645: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-14 08:39:40.663659: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-14 08:39:40.663674: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-14 08:39:40.663691: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-14 08:39:40.663705: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-14 08:39:40.663725: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-14 08:39:40.663740: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-14 08:39:40.663762: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-14 08:39:40.663776: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-14 08:39:40.663797: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-14 08:39:40.663813: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-14 08:39:40.663827: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-14 08:39:40.663848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:39:40.663857: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:39:40.663880: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:39:40.663888: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:39:40.663895: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-14 08:39:40.663900: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-14 08:39:40.663915: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d8c30 :: reshape/Reshape/shape [Const]
2018-11-14 08:39:40.663923: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d8ca8 :: conv1/Const [Const]
2018-11-14 08:39:40.663930: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d8d20 :: conv1/pad_const [Const]
2018-11-14 08:39:40.663937: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d8d98 :: fc1/Reshape/shape [Const]
2018-11-14 08:39:40.663944: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d8e10 :: squash/Const [Const]
2018-11-14 08:39:40.663951: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d8e88 :: fc2/Const [Const]
2018-11-14 08:39:40.663958: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d8f00 :: reshape/Reshape [Reshape]
2018-11-14 08:39:40.663966: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d8fb8 :: conv1/Conv2D [Conv2D]
2018-11-14 08:39:40.663973: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d9070 :: conv1/Square [Square]
2018-11-14 08:39:40.663980: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d9108 :: conv1/Pad [Pad]
2018-11-14 08:39:40.663987: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d91c0 :: fc1/Reshape [Reshape]
2018-11-14 08:39:40.663994: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d9278 :: fc1/MatMul [MatMul]
2018-11-14 08:39:40.664002: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d9330 :: fc1/Square [Square]
2018-11-14 08:39:40.664009: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x66d93c8 :: fc2/MatMul [MatMul]
2018-11-14 08:39:40.664073: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-14 08:39:40.664119: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 5 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-14 08:39:40.664153: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 5, datatype: 1
2018-11-14 08:39:40.664197: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 5 to _retval_fc2/MatMul_0_0[0] in -1, datatype: 1
2018-11-14 08:39:40.665583: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-14 08:39:40.665606: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-14T16:39:41z src/seal/he_seal_util.hpp 45
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
[INFO] 2018-11-14T16:39:41z src/seal/ckks/he_seal_ckks_backend.cpp 115	Creating backend
2018-11-14 08:39:41.785807: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 5
2018-11-14 08:39:41.785884: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-14 08:39:41.785912: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 5
2018-11-14 08:39:41.785934: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_5
2018-11-14 08:39:41.786135: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-14 08:39:41.786287: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-14 08:39:41.786318: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-14 08:39:41.786344: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-14 08:39:41.786384: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-14 08:39:41.786438: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-14 08:39:41.786457: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-14 08:39:41.786465: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-14 08:39:41.786471: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-14 08:39:41.786477: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-14 08:39:41.786489: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-14 08:39:41.786520: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-14 08:39:41.786528: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-14 08:39:41.786535: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-14 08:39:41.786544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-14 08:39:41.786572: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-14 08:39:41.786586: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-14 08:39:41.786593: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-14 08:39:41.786688: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-14 08:39:41.786723: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-14 08:39:41.786772: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-14 08:39:41.786807: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-14 08:39:41.786842: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-14 08:39:41.786851: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-14 08:39:41.786858: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-14 08:39:41.786916: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-14 08:39:41.786948: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-14 08:39:41.786961: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-14 08:39:41.786975: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-14 08:39:41.787009: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-14 08:39:41.787676: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-14 08:39:41.787737: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-14 08:39:41.787775: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-14 08:39:41.787820: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-14 08:39:41.787951: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 5
2018-11-14 08:39:41.787971: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 5
[INFO] 2018-11-14T16:39:41z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:39:41z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 784
2018-11-14 08:39:41.938903: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 5
[INFO] 2018-11-14T16:39:41z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:39:41z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 10
2018-11-14 08:39:41.939674: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 5
2018-11-14 08:39:41.939720: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 5
[INFO] 2018-11-14T16:39:41z src/he_backend.cpp 351	[ Parameter_100 ]
[INFO] 2018-11-14T16:39:41z src/he_backend.cpp 351	[ Constant_117 ]
[INFO] 2018-11-14T16:39:41z src/he_backend.cpp 447	Constant_117 took 0s
[INFO] 2018-11-14T16:39:41z src/he_backend.cpp 351	[ Constant_114 ]
[INFO] 2018-11-14T16:39:43z src/he_backend.cpp 447	Constant_114 took 1s
[INFO] 2018-11-14T16:39:43z src/he_backend.cpp 351	[ Constant_110 ]
[INFO] 2018-11-14T16:39:43z src/he_backend.cpp 447	Constant_110 took 0s
[INFO] 2018-11-14T16:39:43z src/he_backend.cpp 351	[ Constant_103 ]
[INFO] 2018-11-14T16:39:43z src/he_backend.cpp 447	Constant_103 took 0s
[INFO] 2018-11-14T16:39:43z src/he_backend.cpp 351	[ Reshape_102 ]
[INFO] 2018-11-14T16:39:43z src/he_backend.cpp 447	Reshape_102 took 0s
[INFO] 2018-11-14T16:39:43z src/he_backend.cpp 351	[ Reshape_105 ]
[INFO] 2018-11-14T16:39:43z src/he_backend.cpp 447	Reshape_105 took 0s
[INFO] 2018-11-14T16:39:43z src/he_backend.cpp 351	[ Reshape_104 ]
[INFO] 2018-11-14T16:39:43z src/he_backend.cpp 447	Reshape_104 took 0s
[INFO] 2018-11-14T16:39:43z src/he_backend.cpp 351	[ Convolution_106 ]
[INFO] 2018-11-14T16:39:43z src/kernel/convolution.hpp 107	out_transform_size 720
[INFO] 2018-11-14T16:39:48z src/he_backend.cpp 447	Convolution_106 took 5s
[INFO] 2018-11-14T16:39:48z src/he_backend.cpp 351	[ Reshape_107 ]
[INFO] 2018-11-14T16:39:48z src/he_backend.cpp 447	Reshape_107 took 0s
[INFO] 2018-11-14T16:39:48z src/he_backend.cpp 351	[ Multiply_108 ]
[INFO] 2018-11-14T16:39:48z src/he_backend.cpp 447	Multiply_108 took 0s
[INFO] 2018-11-14T16:39:48z src/he_backend.cpp 351	[ Pad_111 ]
[INFO] 2018-11-14T16:39:48z src/kernel/pad.cpp 46	Pad cipher ciper
[INFO] 2018-11-14T16:39:48z src/he_backend.cpp 447	Pad_111 took 0s
[INFO] 2018-11-14T16:39:48z src/he_backend.cpp 351	[ Reshape_113 ]
[INFO] 2018-11-14T16:39:48z src/he_backend.cpp 447	Reshape_113 took 0s
[INFO] 2018-11-14T16:39:48z src/he_backend.cpp 351	[ Dot_115 ]
[INFO] 2018-11-14T16:39:48z src/he_backend.cpp 681	1x845 dot 845x100
[INFO] 2018-11-14T16:39:48z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:40:05z src/he_backend.cpp 447	Dot_115 took 16s
[INFO] 2018-11-14T16:40:05z src/he_backend.cpp 351	[ Multiply_116 ]
[INFO] 2018-11-14T16:40:05z src/he_backend.cpp 447	Multiply_116 took 0s
[INFO] 2018-11-14T16:40:05z src/he_backend.cpp 351	[ Dot_118 ]
[INFO] 2018-11-14T16:40:05z src/he_backend.cpp 681	1x100 dot 100x10
[INFO] 2018-11-14T16:40:05z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:40:05z src/he_backend.cpp 447	Dot_118 took 0s
[INFO] 2018-11-14T16:40:05z src/he_backend.cpp 351	[ Result_119 ]
[INFO] 2018-11-14T16:40:05z src/he_backend.cpp 447	Result_119 took 0s
2018-11-14 08:40:05.585441: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 5
2018-11-14 08:40:05.772753: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 5
total time 5: 25.116824865341187
starting timer 6
2018-11-14 08:40:05.782886: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-14 08:40:05.782914: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-14 08:40:05.782923: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-14 08:40:05.782931: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-14 08:40:05.782938: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-14 08:40:05.782946: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-14 08:40:05.782961: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-14 08:40:05.782972: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-14 08:40:05.782999: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-14 08:40:05.783012: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-14 08:40:05.783022: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-14 08:40:05.783038: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-14 08:40:05.783047: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-14 08:40:05.783057: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-14 08:40:05.783065: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-14 08:40:05.783072: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-14 08:40:05.783079: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/MatMul_0_0
2018-11-14 08:40:05.783085: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:40:05.783134: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-14 08:40:05.783152: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-14 08:40:05.783160: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-14 08:40:05.783169: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-14 08:40:05.783178: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-14 08:40:05.783186: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-14 08:40:05.783195: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-14 08:40:05.783203: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-14 08:40:05.783212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-14 08:40:05.783221: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-14 08:40:05.783229: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-14 08:40:05.783238: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-14 08:40:05.783246: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-14 08:40:05.783254: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-14 08:40:05.783263: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for _arg_Placeholder_0_0[_Arg]
2018-11-14 08:40:05.783271: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:40:05.783341: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-14 08:40:05.783363: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-14 08:40:05.783380: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-14 08:40:05.783394: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-14 08:40:05.783408: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-14 08:40:05.783425: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-14 08:40:05.783439: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-14 08:40:05.783459: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-14 08:40:05.783473: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-14 08:40:05.783495: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-14 08:40:05.783509: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-14 08:40:05.783529: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-14 08:40:05.783544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-14 08:40:05.783558: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-14 08:40:05.783579: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:40:05.783588: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:40:05.783610: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:40:05.783618: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:40:05.783625: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-14 08:40:05.783631: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-14 08:40:05.783645: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697da50 :: reshape/Reshape/shape [Const]
2018-11-14 08:40:05.783653: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697dac8 :: conv1/Const [Const]
2018-11-14 08:40:05.783660: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697db40 :: conv1/pad_const [Const]
2018-11-14 08:40:05.783667: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697dbb8 :: fc1/Reshape/shape [Const]
2018-11-14 08:40:05.783674: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697dc30 :: squash/Const [Const]
2018-11-14 08:40:05.783681: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697dca8 :: fc2/Const [Const]
2018-11-14 08:40:05.783688: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697dd20 :: reshape/Reshape [Reshape]
2018-11-14 08:40:05.783695: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697ddd8 :: conv1/Conv2D [Conv2D]
2018-11-14 08:40:05.783702: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697de90 :: conv1/Square [Square]
2018-11-14 08:40:05.783709: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697df28 :: conv1/Pad [Pad]
2018-11-14 08:40:05.783716: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697dfe0 :: fc1/Reshape [Reshape]
2018-11-14 08:40:05.783723: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697e098 :: fc1/MatMul [MatMul]
2018-11-14 08:40:05.783730: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697e150 :: fc1/Square [Square]
2018-11-14 08:40:05.783737: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0x697e1e8 :: fc2/MatMul [MatMul]
2018-11-14 08:40:05.783799: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-14 08:40:05.783843: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 6 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-14 08:40:05.783876: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 6, datatype: 1
2018-11-14 08:40:05.783915: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 6 to _retval_fc2/MatMul_0_0[0] in -1, datatype: 1
2018-11-14 08:40:05.785902: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-14 08:40:05.785963: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-14T16:40:06z src/seal/he_seal_util.hpp 45
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
[INFO] 2018-11-14T16:40:06z src/seal/ckks/he_seal_ckks_backend.cpp 115	Creating backend
2018-11-14 08:40:06.898668: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 6
2018-11-14 08:40:06.898701: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-14 08:40:06.898711: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 6
2018-11-14 08:40:06.898718: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_6
2018-11-14 08:40:06.898784: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-14 08:40:06.898844: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-14 08:40:06.898864: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-14 08:40:06.898886: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-14 08:40:06.898923: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-14 08:40:06.898969: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-14 08:40:06.898985: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-14 08:40:06.898992: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-14 08:40:06.898998: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-14 08:40:06.899004: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-14 08:40:06.899014: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-14 08:40:06.899061: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-14 08:40:06.899070: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-14 08:40:06.899077: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-14 08:40:06.899085: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-14 08:40:06.899112: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-14 08:40:06.899123: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-14 08:40:06.899131: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-14 08:40:06.899224: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-14 08:40:06.899257: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-14 08:40:06.899300: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-14 08:40:06.899333: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-14 08:40:06.899358: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-14 08:40:06.899367: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-14 08:40:06.899374: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-14 08:40:06.899425: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-14 08:40:06.899454: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-14 08:40:06.899467: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-14 08:40:06.899481: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-14 08:40:06.899513: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-14 08:40:06.900191: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-14 08:40:06.900241: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-14 08:40:06.900279: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-14 08:40:06.900326: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-14 08:40:06.900462: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 6
2018-11-14 08:40:06.900481: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 6
[INFO] 2018-11-14T16:40:06z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:40:06z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 784
2018-11-14 08:40:07.104149: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 6
[INFO] 2018-11-14T16:40:07z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:40:07z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 10
2018-11-14 08:40:07.104994: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 6
2018-11-14 08:40:07.105070: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 6
[INFO] 2018-11-14T16:40:07z src/he_backend.cpp 351	[ Parameter_120 ]
[INFO] 2018-11-14T16:40:07z src/he_backend.cpp 351	[ Constant_137 ]
[INFO] 2018-11-14T16:40:07z src/he_backend.cpp 447	Constant_137 took 0s
[INFO] 2018-11-14T16:40:07z src/he_backend.cpp 351	[ Constant_134 ]
[INFO] 2018-11-14T16:40:08z src/he_backend.cpp 447	Constant_134 took 1s
[INFO] 2018-11-14T16:40:08z src/he_backend.cpp 351	[ Constant_130 ]
[INFO] 2018-11-14T16:40:08z src/he_backend.cpp 447	Constant_130 took 0s
[INFO] 2018-11-14T16:40:08z src/he_backend.cpp 351	[ Constant_123 ]
[INFO] 2018-11-14T16:40:08z src/he_backend.cpp 447	Constant_123 took 0s
[INFO] 2018-11-14T16:40:08z src/he_backend.cpp 351	[ Reshape_122 ]
[INFO] 2018-11-14T16:40:08z src/he_backend.cpp 447	Reshape_122 took 0s
[INFO] 2018-11-14T16:40:08z src/he_backend.cpp 351	[ Reshape_125 ]
[INFO] 2018-11-14T16:40:08z src/he_backend.cpp 447	Reshape_125 took 0s
[INFO] 2018-11-14T16:40:08z src/he_backend.cpp 351	[ Reshape_124 ]
[INFO] 2018-11-14T16:40:08z src/he_backend.cpp 447	Reshape_124 took 0s
[INFO] 2018-11-14T16:40:08z src/he_backend.cpp 351	[ Convolution_126 ]
[INFO] 2018-11-14T16:40:08z src/kernel/convolution.hpp 107	out_transform_size 720
[INFO] 2018-11-14T16:40:13z src/he_backend.cpp 447	Convolution_126 took 5s
[INFO] 2018-11-14T16:40:13z src/he_backend.cpp 351	[ Reshape_127 ]
[INFO] 2018-11-14T16:40:13z src/he_backend.cpp 447	Reshape_127 took 0s
[INFO] 2018-11-14T16:40:13z src/he_backend.cpp 351	[ Multiply_128 ]
[INFO] 2018-11-14T16:40:14z src/he_backend.cpp 447	Multiply_128 took 0s
[INFO] 2018-11-14T16:40:14z src/he_backend.cpp 351	[ Pad_131 ]
[INFO] 2018-11-14T16:40:14z src/kernel/pad.cpp 46	Pad cipher ciper
[INFO] 2018-11-14T16:40:14z src/he_backend.cpp 447	Pad_131 took 0s
[INFO] 2018-11-14T16:40:14z src/he_backend.cpp 351	[ Reshape_133 ]
[INFO] 2018-11-14T16:40:14z src/he_backend.cpp 447	Reshape_133 took 0s
[INFO] 2018-11-14T16:40:14z src/he_backend.cpp 351	[ Dot_135 ]
[INFO] 2018-11-14T16:40:14z src/he_backend.cpp 681	1x845 dot 845x100
[INFO] 2018-11-14T16:40:14z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:40:30z src/he_backend.cpp 447	Dot_135 took 15s
[INFO] 2018-11-14T16:40:30z src/he_backend.cpp 351	[ Multiply_136 ]
[INFO] 2018-11-14T16:40:30z src/he_backend.cpp 447	Multiply_136 took 0s
[INFO] 2018-11-14T16:40:30z src/he_backend.cpp 351	[ Dot_138 ]
[INFO] 2018-11-14T16:40:30z src/he_backend.cpp 681	1x100 dot 100x10
[INFO] 2018-11-14T16:40:30z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:40:30z src/he_backend.cpp 447	Dot_138 took 0s
[INFO] 2018-11-14T16:40:30z src/he_backend.cpp 351	[ Result_139 ]
[INFO] 2018-11-14T16:40:30z src/he_backend.cpp 447	Result_139 took 0s
2018-11-14 08:40:30.490196: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 6
2018-11-14 08:40:30.797199: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 6
total time 6: 25.022016525268555
starting timer 7
2018-11-14 08:40:30.806731: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-14 08:40:30.806762: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-14 08:40:30.806772: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-14 08:40:30.806781: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-14 08:40:30.806789: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-14 08:40:30.806797: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-14 08:40:30.806809: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-14 08:40:30.806825: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-14 08:40:30.806836: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-14 08:40:30.806849: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-14 08:40:30.806858: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-14 08:40:30.806870: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-14 08:40:30.806879: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-14 08:40:30.806890: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-14 08:40:30.806898: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-14 08:40:30.806905: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-14 08:40:30.806912: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/MatMul_0_0
2018-11-14 08:40:30.806918: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:40:30.806968: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-14 08:40:30.806985: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-14 08:40:30.806994: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-14 08:40:30.807002: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-14 08:40:30.807012: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-14 08:40:30.807021: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-14 08:40:30.807029: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-14 08:40:30.807038: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-14 08:40:30.807048: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-14 08:40:30.807056: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-14 08:40:30.807065: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-14 08:40:30.807073: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-14 08:40:30.807082: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-14 08:40:30.807090: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-14 08:40:30.807099: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for _arg_Placeholder_0_0[_Arg]
2018-11-14 08:40:30.807108: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:40:30.807179: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-14 08:40:30.807202: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-14 08:40:30.807220: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-14 08:40:30.807234: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-14 08:40:30.807249: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-14 08:40:30.807266: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-14 08:40:30.807281: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-14 08:40:30.807300: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-14 08:40:30.807315: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-14 08:40:30.807337: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-14 08:40:30.807351: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-14 08:40:30.807372: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-14 08:40:30.807388: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-14 08:40:30.807402: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-14 08:40:30.807423: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:40:30.807432: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:40:30.807455: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:40:30.807464: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:40:30.807470: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-14 08:40:30.807476: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-14 08:40:30.807490: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e8340 :: reshape/Reshape/shape [Const]
2018-11-14 08:40:30.807498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e83b8 :: conv1/Const [Const]
2018-11-14 08:40:30.807505: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e8430 :: conv1/pad_const [Const]
2018-11-14 08:40:30.807512: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e84a8 :: fc1/Reshape/shape [Const]
2018-11-14 08:40:30.807519: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e8520 :: squash/Const [Const]
2018-11-14 08:40:30.807526: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e8598 :: fc2/Const [Const]
2018-11-14 08:40:30.807533: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e8610 :: reshape/Reshape [Reshape]
2018-11-14 08:40:30.807540: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e86c8 :: conv1/Conv2D [Conv2D]
2018-11-14 08:40:30.807547: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e8780 :: conv1/Square [Square]
2018-11-14 08:40:30.807554: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e8818 :: conv1/Pad [Pad]
2018-11-14 08:40:30.807562: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e88d0 :: fc1/Reshape [Reshape]
2018-11-14 08:40:30.807569: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e8988 :: fc1/MatMul [MatMul]
2018-11-14 08:40:30.807576: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e8a40 :: fc1/Square [Square]
2018-11-14 08:40:30.807583: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0x66e8ad8 :: fc2/MatMul [MatMul]
2018-11-14 08:40:30.807647: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-14 08:40:30.807692: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 7 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-14 08:40:30.807724: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 7, datatype: 1
2018-11-14 08:40:30.807766: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 7 to _retval_fc2/MatMul_0_0[0] in -1, datatype: 1
2018-11-14 08:40:30.809626: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-14 08:40:30.809684: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-14T16:40:31z src/seal/he_seal_util.hpp 45
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
[INFO] 2018-11-14T16:40:31z src/seal/ckks/he_seal_ckks_backend.cpp 115	Creating backend
2018-11-14 08:40:31.934807: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 7
2018-11-14 08:40:31.934839: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-14 08:40:31.934849: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 7
2018-11-14 08:40:31.934856: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_7
2018-11-14 08:40:31.934934: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-14 08:40:31.935016: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-14 08:40:31.935043: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-14 08:40:31.935065: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-14 08:40:31.935104: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-14 08:40:31.935152: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-14 08:40:31.935169: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-14 08:40:31.935177: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-14 08:40:31.935183: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-14 08:40:31.935189: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-14 08:40:31.935200: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-14 08:40:31.935230: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-14 08:40:31.935237: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-14 08:40:31.935245: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-14 08:40:31.935253: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-14 08:40:31.935279: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-14 08:40:31.935291: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-14 08:40:31.935298: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-14 08:40:31.935393: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-14 08:40:31.935425: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-14 08:40:31.935475: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-14 08:40:31.935508: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-14 08:40:31.935541: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-14 08:40:31.935550: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-14 08:40:31.935557: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-14 08:40:31.935610: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-14 08:40:31.935639: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-14 08:40:31.935652: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-14 08:40:31.935666: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-14 08:40:31.935698: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-14 08:40:31.936341: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-14 08:40:31.936409: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-14 08:40:31.936448: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-14 08:40:31.936492: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-14 08:40:31.936617: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 7
2018-11-14 08:40:31.936635: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 7
[INFO] 2018-11-14T16:40:31z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:40:31z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 784
2018-11-14 08:40:32.096611: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 7
[INFO] 2018-11-14T16:40:32z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:40:32z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 10
2018-11-14 08:40:32.097159: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 7
2018-11-14 08:40:32.097174: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 7
[INFO] 2018-11-14T16:40:32z src/he_backend.cpp 351	[ Parameter_140 ]
[INFO] 2018-11-14T16:40:32z src/he_backend.cpp 351	[ Constant_157 ]
[INFO] 2018-11-14T16:40:32z src/he_backend.cpp 447	Constant_157 took 0s
[INFO] 2018-11-14T16:40:32z src/he_backend.cpp 351	[ Constant_154 ]
[INFO] 2018-11-14T16:40:33z src/he_backend.cpp 447	Constant_154 took 1s
[INFO] 2018-11-14T16:40:33z src/he_backend.cpp 351	[ Constant_150 ]
[INFO] 2018-11-14T16:40:33z src/he_backend.cpp 447	Constant_150 took 0s
[INFO] 2018-11-14T16:40:33z src/he_backend.cpp 351	[ Constant_143 ]
[INFO] 2018-11-14T16:40:33z src/he_backend.cpp 447	Constant_143 took 0s
[INFO] 2018-11-14T16:40:33z src/he_backend.cpp 351	[ Reshape_142 ]
[INFO] 2018-11-14T16:40:33z src/he_backend.cpp 447	Reshape_142 took 0s
[INFO] 2018-11-14T16:40:33z src/he_backend.cpp 351	[ Reshape_145 ]
[INFO] 2018-11-14T16:40:33z src/he_backend.cpp 447	Reshape_145 took 0s
[INFO] 2018-11-14T16:40:33z src/he_backend.cpp 351	[ Reshape_144 ]
[INFO] 2018-11-14T16:40:33z src/he_backend.cpp 447	Reshape_144 took 0s
[INFO] 2018-11-14T16:40:33z src/he_backend.cpp 351	[ Convolution_146 ]
[INFO] 2018-11-14T16:40:33z src/kernel/convolution.hpp 107	out_transform_size 720
[INFO] 2018-11-14T16:40:38z src/he_backend.cpp 447	Convolution_146 took 5s
[INFO] 2018-11-14T16:40:38z src/he_backend.cpp 351	[ Reshape_147 ]
[INFO] 2018-11-14T16:40:38z src/he_backend.cpp 447	Reshape_147 took 0s
[INFO] 2018-11-14T16:40:38z src/he_backend.cpp 351	[ Multiply_148 ]
[INFO] 2018-11-14T16:40:38z src/he_backend.cpp 447	Multiply_148 took 0s
[INFO] 2018-11-14T16:40:38z src/he_backend.cpp 351	[ Pad_151 ]
[INFO] 2018-11-14T16:40:38z src/kernel/pad.cpp 46	Pad cipher ciper
[INFO] 2018-11-14T16:40:38z src/he_backend.cpp 447	Pad_151 took 0s
[INFO] 2018-11-14T16:40:38z src/he_backend.cpp 351	[ Reshape_153 ]
[INFO] 2018-11-14T16:40:38z src/he_backend.cpp 447	Reshape_153 took 0s
[INFO] 2018-11-14T16:40:38z src/he_backend.cpp 351	[ Dot_155 ]
[INFO] 2018-11-14T16:40:38z src/he_backend.cpp 681	1x845 dot 845x100
[INFO] 2018-11-14T16:40:38z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:40:55z src/he_backend.cpp 447	Dot_155 took 16s
[INFO] 2018-11-14T16:40:55z src/he_backend.cpp 351	[ Multiply_156 ]
[INFO] 2018-11-14T16:40:55z src/he_backend.cpp 447	Multiply_156 took 0s
[INFO] 2018-11-14T16:40:55z src/he_backend.cpp 351	[ Dot_158 ]
[INFO] 2018-11-14T16:40:55z src/he_backend.cpp 681	1x100 dot 100x10
[INFO] 2018-11-14T16:40:55z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:40:55z src/he_backend.cpp 447	Dot_158 took 0s
[INFO] 2018-11-14T16:40:55z src/he_backend.cpp 351	[ Result_159 ]
[INFO] 2018-11-14T16:40:55z src/he_backend.cpp 447	Result_159 took 0s
2018-11-14 08:40:55.420363: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 7
2018-11-14 08:40:55.605378: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 7
total time 7: 24.80589246749878
starting timer 8
2018-11-14 08:40:55.615036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-14 08:40:55.615064: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-14 08:40:55.615073: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-14 08:40:55.615081: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-14 08:40:55.615088: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-14 08:40:55.615096: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-14 08:40:55.615111: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-14 08:40:55.615124: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-14 08:40:55.615151: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-14 08:40:55.615164: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-14 08:40:55.615174: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-14 08:40:55.615192: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-14 08:40:55.615201: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-14 08:40:55.615210: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-14 08:40:55.615219: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-14 08:40:55.615225: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-14 08:40:55.615232: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/MatMul_0_0
2018-11-14 08:40:55.615239: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:40:55.615295: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-14 08:40:55.615314: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-14 08:40:55.615323: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-14 08:40:55.615332: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-14 08:40:55.615341: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-14 08:40:55.615349: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-14 08:40:55.615357: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-14 08:40:55.615366: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-14 08:40:55.615375: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-14 08:40:55.615383: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-14 08:40:55.615391: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-14 08:40:55.615400: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-14 08:40:55.615409: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-14 08:40:55.615417: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-14 08:40:55.615425: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for _arg_Placeholder_0_0[_Arg]
2018-11-14 08:40:55.615434: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:40:55.615509: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-14 08:40:55.615532: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-14 08:40:55.615550: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-14 08:40:55.615563: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-14 08:40:55.615577: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-14 08:40:55.615594: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-14 08:40:55.615608: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-14 08:40:55.615628: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-14 08:40:55.615642: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-14 08:40:55.615664: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-14 08:40:55.615678: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-14 08:40:55.615698: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-14 08:40:55.615714: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-14 08:40:55.615728: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-14 08:40:55.615749: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:40:55.615757: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:40:55.615780: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:40:55.615788: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:40:55.615795: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-14 08:40:55.615800: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-14 08:40:55.615817: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6985460 :: reshape/Reshape/shape [Const]
2018-11-14 08:40:55.615825: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x69854d8 :: conv1/Const [Const]
2018-11-14 08:40:55.615832: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6985550 :: conv1/pad_const [Const]
2018-11-14 08:40:55.615839: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x69855c8 :: fc1/Reshape/shape [Const]
2018-11-14 08:40:55.615846: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6985640 :: squash/Const [Const]
2018-11-14 08:40:55.615853: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x69856b8 :: fc2/Const [Const]
2018-11-14 08:40:55.615860: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6985730 :: reshape/Reshape [Reshape]
2018-11-14 08:40:55.615867: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x69857e8 :: conv1/Conv2D [Conv2D]
2018-11-14 08:40:55.615874: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x69858a0 :: conv1/Square [Square]
2018-11-14 08:40:55.615881: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6985938 :: conv1/Pad [Pad]
2018-11-14 08:40:55.615888: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x69859f0 :: fc1/Reshape [Reshape]
2018-11-14 08:40:55.615895: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6985aa8 :: fc1/MatMul [MatMul]
2018-11-14 08:40:55.615902: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6985b60 :: fc1/Square [Square]
2018-11-14 08:40:55.615909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0x6985bf8 :: fc2/MatMul [MatMul]
2018-11-14 08:40:55.615972: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-14 08:40:55.616017: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 8 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-14 08:40:55.616051: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 8, datatype: 1
2018-11-14 08:40:55.616097: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 8 to _retval_fc2/MatMul_0_0[0] in -1, datatype: 1
2018-11-14 08:40:55.617733: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-14 08:40:55.617790: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-14T16:40:56z src/seal/he_seal_util.hpp 45
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
[INFO] 2018-11-14T16:40:56z src/seal/ckks/he_seal_ckks_backend.cpp 115	Creating backend
2018-11-14 08:40:56.747927: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 8
2018-11-14 08:40:56.748002: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-14 08:40:56.748026: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 8
2018-11-14 08:40:56.748048: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_8
2018-11-14 08:40:56.748214: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-14 08:40:56.748387: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-14 08:40:56.748446: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-14 08:40:56.748481: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-14 08:40:56.748516: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-14 08:40:56.748564: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-14 08:40:56.748580: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-14 08:40:56.748588: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-14 08:40:56.748594: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-14 08:40:56.748599: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-14 08:40:56.748610: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-14 08:40:56.748640: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-14 08:40:56.748647: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-14 08:40:56.748655: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-14 08:40:56.748663: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-14 08:40:56.748689: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-14 08:40:56.748701: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-14 08:40:56.748708: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-14 08:40:56.748800: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-14 08:40:56.748832: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-14 08:40:56.748873: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-14 08:40:56.748904: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-14 08:40:56.748927: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-14 08:40:56.748936: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-14 08:40:56.748943: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-14 08:40:56.748995: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-14 08:40:56.749023: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-14 08:40:56.749035: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-14 08:40:56.749049: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-14 08:40:56.749080: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-14 08:40:56.749796: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-14 08:40:56.749844: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-14 08:40:56.749880: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-14 08:40:56.749922: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-14 08:40:56.750037: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 8
2018-11-14 08:40:56.750054: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 8
[INFO] 2018-11-14T16:40:56z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:40:56z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 784
2018-11-14 08:40:56.989770: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 8
[INFO] 2018-11-14T16:40:56z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:40:56z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 10
2018-11-14 08:40:56.990547: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 8
2018-11-14 08:40:56.990561: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 8
[INFO] 2018-11-14T16:40:56z src/he_backend.cpp 351	[ Parameter_160 ]
[INFO] 2018-11-14T16:40:56z src/he_backend.cpp 351	[ Constant_177 ]
[INFO] 2018-11-14T16:40:57z src/he_backend.cpp 447	Constant_177 took 0s
[INFO] 2018-11-14T16:40:57z src/he_backend.cpp 351	[ Constant_174 ]
[INFO] 2018-11-14T16:40:58z src/he_backend.cpp 447	Constant_174 took 1s
[INFO] 2018-11-14T16:40:58z src/he_backend.cpp 351	[ Constant_170 ]
[INFO] 2018-11-14T16:40:58z src/he_backend.cpp 447	Constant_170 took 0s
[INFO] 2018-11-14T16:40:58z src/he_backend.cpp 351	[ Constant_163 ]
[INFO] 2018-11-14T16:40:58z src/he_backend.cpp 447	Constant_163 took 0s
[INFO] 2018-11-14T16:40:58z src/he_backend.cpp 351	[ Reshape_162 ]
[INFO] 2018-11-14T16:40:58z src/he_backend.cpp 447	Reshape_162 took 0s
[INFO] 2018-11-14T16:40:58z src/he_backend.cpp 351	[ Reshape_165 ]
[INFO] 2018-11-14T16:40:58z src/he_backend.cpp 447	Reshape_165 took 0s
[INFO] 2018-11-14T16:40:58z src/he_backend.cpp 351	[ Reshape_164 ]
[INFO] 2018-11-14T16:40:58z src/he_backend.cpp 447	Reshape_164 took 0s
[INFO] 2018-11-14T16:40:58z src/he_backend.cpp 351	[ Convolution_166 ]
[INFO] 2018-11-14T16:40:58z src/kernel/convolution.hpp 107	out_transform_size 720
[INFO] 2018-11-14T16:41:03z src/he_backend.cpp 447	Convolution_166 took 5s
[INFO] 2018-11-14T16:41:03z src/he_backend.cpp 351	[ Reshape_167 ]
[INFO] 2018-11-14T16:41:03z src/he_backend.cpp 447	Reshape_167 took 0s
[INFO] 2018-11-14T16:41:03z src/he_backend.cpp 351	[ Multiply_168 ]
[INFO] 2018-11-14T16:41:03z src/he_backend.cpp 447	Multiply_168 took 0s
[INFO] 2018-11-14T16:41:03z src/he_backend.cpp 351	[ Pad_171 ]
[INFO] 2018-11-14T16:41:03z src/kernel/pad.cpp 46	Pad cipher ciper
[INFO] 2018-11-14T16:41:03z src/he_backend.cpp 447	Pad_171 took 0s
[INFO] 2018-11-14T16:41:03z src/he_backend.cpp 351	[ Reshape_173 ]
[INFO] 2018-11-14T16:41:03z src/he_backend.cpp 447	Reshape_173 took 0s
[INFO] 2018-11-14T16:41:03z src/he_backend.cpp 351	[ Dot_175 ]
[INFO] 2018-11-14T16:41:03z src/he_backend.cpp 681	1x845 dot 845x100
[INFO] 2018-11-14T16:41:03z src/he_backend.cpp 698	Dot cipher plain => cipher
 [INFO] 2018-11-14T16:41:20z src/he_backend.cpp 447	Dot_175 took 16s
[INFO] 2018-11-14T16:41:20z src/he_backend.cpp 351	[ Multiply_176 ]
[INFO] 2018-11-14T16:41:20z src/he_backend.cpp 447	Multiply_176 took 0s
[INFO] 2018-11-14T16:41:20z src/he_backend.cpp 351	[ Dot_178 ]
[INFO] 2018-11-14T16:41:20z src/he_backend.cpp 681	1x100 dot 100x10
[INFO] 2018-11-14T16:41:20z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:41:20z src/he_backend.cpp 447	Dot_178 took 0s
[INFO] 2018-11-14T16:41:20z src/he_backend.cpp 351	[ Result_179 ]
[INFO] 2018-11-14T16:41:20z src/he_backend.cpp 447	Result_179 took 0s
2018-11-14 08:41:20.402137: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 8
2018-11-14 08:41:20.702710: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 8
total time 8: 25.094730854034424
starting timer 9
2018-11-14 08:41:20.711748: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-14 08:41:20.711780: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-14 08:41:20.711791: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-14 08:41:20.711802: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-14 08:41:20.711812: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-14 08:41:20.711824: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-14 08:41:20.711846: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-14 08:41:20.711874: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-14 08:41:20.711889: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-14 08:41:20.711908: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-14 08:41:20.711919: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-14 08:41:20.711933: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-14 08:41:20.711944: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-14 08:41:20.711955: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-14 08:41:20.711966: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-14 08:41:20.711973: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-14 08:41:20.711981: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/MatMul_0_0
2018-11-14 08:41:20.711988: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:41:20.712039: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-14 08:41:20.712057: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-14 08:41:20.712067: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-14 08:41:20.712077: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-14 08:41:20.712088: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-14 08:41:20.712097: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-14 08:41:20.712107: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-14 08:41:20.712117: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-14 08:41:20.712127: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-14 08:41:20.712137: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-14 08:41:20.712147: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-14 08:41:20.712157: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-14 08:41:20.712167: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-14 08:41:20.712176: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-14 08:41:20.712186: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for _arg_Placeholder_0_0[_Arg]
2018-11-14 08:41:20.712196: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:41:20.712265: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-14 08:41:20.712289: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-14 08:41:20.712307: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-14 08:41:20.712323: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-14 08:41:20.712339: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-14 08:41:20.712364: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-14 08:41:20.712381: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-14 08:41:20.712402: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-14 08:41:20.712418: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-14 08:41:20.712442: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-14 08:41:20.712458: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-14 08:41:20.712480: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-14 08:41:20.712497: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-14 08:41:20.712513: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-14 08:41:20.712536: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:41:20.712546: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:41:20.712571: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:41:20.712581: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:41:20.712588: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-14 08:41:20.712594: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-14 08:41:20.712609: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e5360 :: reshape/Reshape/shape [Const]
2018-11-14 08:41:20.712626: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e53d8 :: conv1/Const [Const]
2018-11-14 08:41:20.712634: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e5450 :: conv1/pad_const [Const]
2018-11-14 08:41:20.712642: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e54c8 :: fc1/Reshape/shape [Const]
2018-11-14 08:41:20.712651: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e5540 :: squash/Const [Const]
2018-11-14 08:41:20.712659: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e55b8 :: fc2/Const [Const]
2018-11-14 08:41:20.712667: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e5630 :: reshape/Reshape [Reshape]
2018-11-14 08:41:20.712676: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e56e8 :: conv1/Conv2D [Conv2D]
2018-11-14 08:41:20.712684: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e57a0 :: conv1/Square [Square]
2018-11-14 08:41:20.712692: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e5838 :: conv1/Pad [Pad]
2018-11-14 08:41:20.712700: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e58f0 :: fc1/Reshape [Reshape]
2018-11-14 08:41:20.712709: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e59a8 :: fc1/MatMul [MatMul]
2018-11-14 08:41:20.712717: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e5a60 :: fc1/Square [Square]
2018-11-14 08:41:20.712725: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x66e5af8 :: fc2/MatMul [MatMul]
2018-11-14 08:41:20.712790: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-14 08:41:20.712835: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 9 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-14 08:41:20.712869: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 9, datatype: 1
2018-11-14 08:41:20.712911: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 9 to _retval_fc2/MatMul_0_0[0] in -1, datatype: 1
2018-11-14 08:41:20.714748: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-14 08:41:20.714806: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-14T16:41:21z src/seal/he_seal_util.hpp 45
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
[INFO] 2018-11-14T16:41:21z src/seal/ckks/he_seal_ckks_backend.cpp 115	Creating backend
2018-11-14 08:41:21.846543: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 9
2018-11-14 08:41:21.846567: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-14 08:41:21.846576: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 9
2018-11-14 08:41:21.846583: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_9
2018-11-14 08:41:21.846647: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-14 08:41:21.846704: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-14 08:41:21.846724: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-14 08:41:21.846745: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-14 08:41:21.846781: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-14 08:41:21.846826: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-14 08:41:21.846843: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-14 08:41:21.846850: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-14 08:41:21.846856: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-14 08:41:21.846862: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-14 08:41:21.846873: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-14 08:41:21.846904: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-14 08:41:21.846911: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-14 08:41:21.846918: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-14 08:41:21.846927: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-14 08:41:21.846953: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-14 08:41:21.846966: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-14 08:41:21.846973: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-14 08:41:21.847066: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-14 08:41:21.847099: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-14 08:41:21.847142: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-14 08:41:21.847175: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-14 08:41:21.847199: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-14 08:41:21.847209: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-14 08:41:21.847216: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-14 08:41:21.847266: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-14 08:41:21.847295: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-14 08:41:21.847309: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-14 08:41:21.847322: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-14 08:41:21.847355: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-14 08:41:21.848025: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-14 08:41:21.848075: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-14 08:41:21.848112: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-14 08:41:21.848156: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-14 08:41:21.848279: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 9
2018-11-14 08:41:21.848297: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 9
[INFO] 2018-11-14T16:41:21z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:41:21z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 784
2018-11-14 08:41:21.965542: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 9
[INFO] 2018-11-14T16:41:21z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:41:21z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 10
2018-11-14 08:41:21.966187: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 9
2018-11-14 08:41:21.966202: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 9
[INFO] 2018-11-14T16:41:21z src/he_backend.cpp 351	[ Parameter_180 ]
[INFO] 2018-11-14T16:41:21z src/he_backend.cpp 351	[ Constant_197 ]
[INFO] 2018-11-14T16:41:21z src/he_backend.cpp 447	Constant_197 took 0s
[INFO] 2018-11-14T16:41:21z src/he_backend.cpp 351	[ Constant_194 ]
[INFO] 2018-11-14T16:41:23z src/he_backend.cpp 447	Constant_194 took 1s
[INFO] 2018-11-14T16:41:23z src/he_backend.cpp 351	[ Constant_190 ]
[INFO] 2018-11-14T16:41:23z src/he_backend.cpp 447	Constant_190 took 0s
[INFO] 2018-11-14T16:41:23z src/he_backend.cpp 351	[ Constant_183 ]
[INFO] 2018-11-14T16:41:23z src/he_backend.cpp 447	Constant_183 took 0s
[INFO] 2018-11-14T16:41:23z src/he_backend.cpp 351	[ Reshape_182 ]
[INFO] 2018-11-14T16:41:23z src/he_backend.cpp 447	Reshape_182 took 0s
[INFO] 2018-11-14T16:41:23z src/he_backend.cpp 351	[ Reshape_185 ]
[INFO] 2018-11-14T16:41:23z src/he_backend.cpp 447	Reshape_185 took 0s
[INFO] 2018-11-14T16:41:23z src/he_backend.cpp 351	[ Reshape_184 ]
[INFO] 2018-11-14T16:41:23z src/he_backend.cpp 447	Reshape_184 took 0s
[INFO] 2018-11-14T16:41:23z src/he_backend.cpp 351	[ Convolution_186 ]
[INFO] 2018-11-14T16:41:23z src/kernel/convolution.hpp 107	out_transform_size 720
[INFO] 2018-11-14T16:41:28z src/he_backend.cpp 447	Convolution_186 took 5s
[INFO] 2018-11-14T16:41:28z src/he_backend.cpp 351	[ Reshape_187 ]
[INFO] 2018-11-14T16:41:28z src/he_backend.cpp 447	Reshape_187 took 0s
[INFO] 2018-11-14T16:41:28z src/he_backend.cpp 351	[ Multiply_188 ]
[INFO] 2018-11-14T16:41:28z src/he_backend.cpp 447	Multiply_188 took 0s
[INFO] 2018-11-14T16:41:28z src/he_backend.cpp 351	[ Pad_191 ]
[INFO] 2018-11-14T16:41:28z src/kernel/pad.cpp 46	Pad cipher ciper
[INFO] 2018-11-14T16:41:28z src/he_backend.cpp 447	Pad_191 took 0s
[INFO] 2018-11-14T16:41:28z src/he_backend.cpp 351	[ Reshape_193 ]
[INFO] 2018-11-14T16:41:28z src/he_backend.cpp 447	Reshape_193 took 0s
[INFO] 2018-11-14T16:41:28z src/he_backend.cpp 351	[ Dot_195 ]
[INFO] 2018-11-14T16:41:28z src/he_backend.cpp 681	1x845 dot 845x100
[INFO] 2018-11-14T16:41:28z src/he_backend.cpp 698	Dot cipher plain => cipher
 [INFO] 2018-11-14T16:41:44z src/he_backend.cpp 447	Dot_195 took 15s
[INFO] 2018-11-14T16:41:44z src/he_backend.cpp 351	[ Multiply_196 ]
[INFO] 2018-11-14T16:41:44z src/he_backend.cpp 447	Multiply_196 took 0s
[INFO] 2018-11-14T16:41:44z src/he_backend.cpp 351	[ Dot_198 ]
[INFO] 2018-11-14T16:41:44z src/he_backend.cpp 681	1x100 dot 100x10
[INFO] 2018-11-14T16:41:44z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:41:44z src/he_backend.cpp 447	Dot_198 took 0s
[INFO] 2018-11-14T16:41:44z src/he_backend.cpp 351	[ Result_199 ]
[INFO] 2018-11-14T16:41:44z src/he_backend.cpp 447	Result_199 took 0s
2018-11-14 08:41:44.996541: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 9
2018-11-14 08:41:45.186043: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 9
total time 9: 24.48110842704773
starting timer 10
2018-11-14 08:41:45.196129: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-14 08:41:45.196171: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-14 08:41:45.196197: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-14 08:41:45.196206: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-14 08:41:45.196216: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-14 08:41:45.196234: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-14 08:41:45.196264: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-14 08:41:45.196274: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-14 08:41:45.196286: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-14 08:41:45.196307: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-14 08:41:45.196317: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-14 08:41:45.196328: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-14 08:41:45.196338: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-14 08:41:45.196347: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-14 08:41:45.196364: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-14 08:41:45.196371: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-14 08:41:45.196379: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/MatMul_0_0
2018-11-14 08:41:45.196385: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:41:45.196450: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-14 08:41:45.196474: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-14 08:41:45.196484: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-14 08:41:45.196492: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-14 08:41:45.196502: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-14 08:41:45.196511: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-14 08:41:45.196519: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-14 08:41:45.196528: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-14 08:41:45.196537: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-14 08:41:45.196546: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-14 08:41:45.196554: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-14 08:41:45.196563: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-14 08:41:45.196572: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-14 08:41:45.196581: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-14 08:41:45.196589: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for _arg_Placeholder_0_0[_Arg]
2018-11-14 08:41:45.196598: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _retval_fc2/MatMul_0_0[_Retval]
2018-11-14 08:41:45.196680: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-14 08:41:45.196706: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-14 08:41:45.196725: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-14 08:41:45.196739: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-14 08:41:45.196754: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-14 08:41:45.196771: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-14 08:41:45.196786: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-14 08:41:45.196806: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-14 08:41:45.196820: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-14 08:41:45.196843: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-14 08:41:45.196858: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-14 08:41:45.196878: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-14 08:41:45.196895: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-14 08:41:45.196909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-14 08:41:45.196930: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:41:45.196939: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:41:45.196963: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@14 -> reshape/Reshape[0]@5
2018-11-14 08:41:45.196971: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> _retval_fc2/MatMul_0_0[0]@15
2018-11-14 08:41:45.196978: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-14 08:41:45.196983: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-14 08:41:45.196998: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x697fd50 :: reshape/Reshape/shape [Const]
2018-11-14 08:41:45.197006: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x697fdc8 :: conv1/Const [Const]
2018-11-14 08:41:45.197014: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x697fe40 :: conv1/pad_const [Const]
2018-11-14 08:41:45.197021: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x697feb8 :: fc1/Reshape/shape [Const]
2018-11-14 08:41:45.197028: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x697ff30 :: squash/Const [Const]
2018-11-14 08:41:45.197036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x697ffa8 :: fc2/Const [Const]
2018-11-14 08:41:45.197043: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x6980020 :: reshape/Reshape [Reshape]
2018-11-14 08:41:45.197050: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x69800d8 :: conv1/Conv2D [Conv2D]
2018-11-14 08:41:45.197058: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x6980190 :: conv1/Square [Square]
2018-11-14 08:41:45.197065: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x6980228 :: conv1/Pad [Pad]
2018-11-14 08:41:45.197072: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x69802e0 :: fc1/Reshape [Reshape]
2018-11-14 08:41:45.197079: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x6980398 :: fc1/MatMul [MatMul]
2018-11-14 08:41:45.197086: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x6980450 :: fc1/Square [Square]
2018-11-14 08:41:45.197093: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0x69804e8 :: fc2/MatMul [MatMul]
2018-11-14 08:41:45.197158: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-14 08:41:45.197209: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 10 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-14 08:41:45.197244: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 10, datatype: 1
2018-11-14 08:41:45.197296: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 10 to _retval_fc2/MatMul_0_0[0] in -1, datatype: 1
2018-11-14 08:41:45.198492: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-14 08:41:45.198511: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-14T16:41:46z src/seal/he_seal_util.hpp 45
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 8192
| coeff_modulus size: 210 bits
\ noise_standard_deviation: 3.19
[INFO] 2018-11-14T16:41:46z src/seal/ckks/he_seal_ckks_backend.cpp 115	Creating backend
2018-11-14 08:41:46.289917: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 10
2018-11-14 08:41:46.289959: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-14 08:41:46.289970: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 10
2018-11-14 08:41:46.289978: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_10
2018-11-14 08:41:46.290068: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-14 08:41:46.290141: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-14 08:41:46.290164: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-14 08:41:46.290187: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-14 08:41:46.290226: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-14 08:41:46.290276: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-14 08:41:46.290295: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-14 08:41:46.290303: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-14 08:41:46.290309: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-14 08:41:46.290315: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-14 08:41:46.290327: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-14 08:41:46.290357: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-14 08:41:46.290365: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-14 08:41:46.290372: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-14 08:41:46.290381: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-14 08:41:46.290416: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-14 08:41:46.290429: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-14 08:41:46.290436: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-14 08:41:46.290531: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-14 08:41:46.290564: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-14 08:41:46.290608: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-14 08:41:46.290643: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-14 08:41:46.290667: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-14 08:41:46.290676: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-14 08:41:46.290684: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-14 08:41:46.290737: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-14 08:41:46.290768: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-14 08:41:46.290781: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-14 08:41:46.290795: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-14 08:41:46.290827: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-14 08:41:46.291504: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-14 08:41:46.291557: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-14 08:41:46.291594: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-14 08:41:46.291638: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-14 08:41:46.291765: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 10
2018-11-14 08:41:46.291784: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 10
[INFO] 2018-11-14T16:41:46z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:41:46z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 784
2018-11-14 08:41:46.503059: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 10
[INFO] 2018-11-14T16:41:46z src/he_backend.cpp 98	Creating batched tensor
[INFO] 2018-11-14T16:41:46z src/seal/ckks/he_seal_ckks_backend.cpp 303	Creating batched tensor with shape 1, 10
2018-11-14 08:41:46.503773: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 10
2018-11-14 08:41:46.503790: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 10
[INFO] 2018-11-14T16:41:46z src/he_backend.cpp 351	[ Parameter_200 ]
[INFO] 2018-11-14T16:41:46z src/he_backend.cpp 351	[ Constant_217 ]
[INFO] 2018-11-14T16:41:46z src/he_backend.cpp 447	Constant_217 took 0s
[INFO] 2018-11-14T16:41:46z src/he_backend.cpp 351	[ Constant_214 ]
[INFO] 2018-11-14T16:41:47z src/he_backend.cpp 447	Constant_214 took 1s
[INFO] 2018-11-14T16:41:47z src/he_backend.cpp 351	[ Constant_210 ]
[INFO] 2018-11-14T16:41:47z src/he_backend.cpp 447	Constant_210 took 0s
[INFO] 2018-11-14T16:41:47z src/he_backend.cpp 351	[ Constant_203 ]
[INFO] 2018-11-14T16:41:47z src/he_backend.cpp 447	Constant_203 took 0s
[INFO] 2018-11-14T16:41:47z src/he_backend.cpp 351	[ Reshape_202 ]
[INFO] 2018-11-14T16:41:47z src/he_backend.cpp 447	Reshape_202 took 0s
[INFO] 2018-11-14T16:41:47z src/he_backend.cpp 351	[ Reshape_205 ]
[INFO] 2018-11-14T16:41:47z src/he_backend.cpp 447	Reshape_205 took 0s
[INFO] 2018-11-14T16:41:47z src/he_backend.cpp 351	[ Reshape_204 ]
[INFO] 2018-11-14T16:41:47z src/he_backend.cpp 447	Reshape_204 took 0s
[INFO] 2018-11-14T16:41:47z src/he_backend.cpp 351	[ Convolution_206 ]
[INFO] 2018-11-14T16:41:47z src/kernel/convolution.hpp 107	out_transform_size 720
[INFO] 2018-11-14T16:41:53z src/he_backend.cpp 447	Convolution_206 took 5s
[INFO] 2018-11-14T16:41:53z src/he_backend.cpp 351	[ Reshape_207 ]
[INFO] 2018-11-14T16:41:53z src/he_backend.cpp 447	Reshape_207 took 0s
[INFO] 2018-11-14T16:41:53z src/he_backend.cpp 351	[ Multiply_208 ]
[INFO] 2018-11-14T16:41:53z src/he_backend.cpp 447	Multiply_208 took 0s
[INFO] 2018-11-14T16:41:53z src/he_backend.cpp 351	[ Pad_211 ]
[INFO] 2018-11-14T16:41:53z src/kernel/pad.cpp 46	Pad cipher ciper
[INFO] 2018-11-14T16:41:53z src/he_backend.cpp 447	Pad_211 took 0s
[INFO] 2018-11-14T16:41:53z src/he_backend.cpp 351	[ Reshape_213 ]
[INFO] 2018-11-14T16:41:53z src/he_backend.cpp 447	Reshape_213 took 0s
[INFO] 2018-11-14T16:41:53z src/he_backend.cpp 351	[ Dot_215 ]
[INFO] 2018-11-14T16:41:53z src/he_backend.cpp 681	1x845 dot 845x100
[INFO] 2018-11-14T16:41:53z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:42:10z src/he_backend.cpp 447	Dot_215 took 16s
[INFO] 2018-11-14T16:42:10z src/he_backend.cpp 351	[ Multiply_216 ]
[INFO] 2018-11-14T16:42:10z src/he_backend.cpp 447	Multiply_216 took 0s
[INFO] 2018-11-14T16:42:10z src/he_backend.cpp 351	[ Dot_218 ]
[INFO] 2018-11-14T16:42:10z src/he_backend.cpp 681	1x100 dot 100x10
[INFO] 2018-11-14T16:42:10z src/he_backend.cpp 698	Dot cipher plain => cipher
[INFO] 2018-11-14T16:42:10z src/he_backend.cpp 447	Dot_218 took 0s
[INFO] 2018-11-14T16:42:10z src/he_backend.cpp 351	[ Result_219 ]
[INFO] 2018-11-14T16:42:10z src/he_backend.cpp 447	Result_219 took 0s
2018-11-14 08:42:10.689060: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 10
2018-11-14 08:42:10.946848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 10
total time 10: 25.757550716400146
can't reserialize!