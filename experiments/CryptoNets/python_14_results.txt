(he3) ➜  cryptonets git:(fboemer/cryptonets-timings) ✗ NGRAPH_TF_VLOG_LEVEL=5 NGRAPH_ENCRYPT_DATA=1 NGRAPH_BATCH_DATA=1 NGRAPH_BATCH_TF=1 NGRAPH_HE_SEAL_CONFIG=../../test/model/he_seal_ckks_config_14.json NGRAPH_TF_BACKEND=HE:SEAL:CKKS python test.py
TensorFlow version installed: 1.12.0 (v1.12.0-0-ga6d8ffae09)
nGraph bridge built with: 1.12.0 (v1.12.0-0-ga6d8ffae09)
Extracting /tmp/tensorflow/mnist/input_data/train-images-idx3-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/train-labels-idx1-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/t10k-images-idx3-ubyte.gz
Extracting /tmp/tensorflow/mnist/input_data/t10k-labels-idx1-ubyte.gz
2018-11-27 08:20:43.713592: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2018-11-27 08:20:43.748450: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 08:20:43.748482: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 08:20:43.748493: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 08:20:43.748502: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 08:20:43.748511: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 08:20:43.748521: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 08:20:43.748531: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 08:20:43.748541: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 08:20:43.748551: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 08:20:43.748562: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 08:20:43.748572: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 08:20:43.748581: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 08:20:43.748590: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 08:20:43.748599: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 08:20:43.748608: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 08:20:43.748615: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 08:20:43.748644: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 08:20:43.748650: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 08:20:43.748658: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 08:20:43.748664: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:20:43.748701: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 08:20:43.748718: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 08:20:43.748727: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 08:20:43.748736: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 08:20:43.748745: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 08:20:43.748754: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 08:20:43.748763: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 08:20:43.748772: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 08:20:43.748781: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 08:20:43.748790: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 08:20:43.748798: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 08:20:43.748807: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 08:20:43.748816: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 08:20:43.748824: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 08:20:43.748833: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 08:20:43.748842: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 08:20:43.748851: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:20:43.748926: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 08:20:43.748949: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 08:20:43.748966: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 08:20:43.748980: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 08:20:43.748995: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 08:20:43.749012: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 08:20:43.749026: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 08:20:43.749046: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 08:20:43.749060: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 08:20:43.749082: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 08:20:43.749097: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 08:20:43.749117: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 08:20:43.749133: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 08:20:43.749147: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 08:20:43.749168: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:20:43.749176: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:20:43.749185: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:20:43.749193: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:20:43.749214: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:20:43.749222: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:20:43.749231: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:20:43.749238: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:20:43.749245: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 08:20:43.749250: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 08:20:43.749266: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f6b30 :: reshape/Reshape/shape [Const]
2018-11-27 08:20:43.749274: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f6ba8 :: conv1/Const [Const]
2018-11-27 08:20:43.749281: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f6c20 :: conv1/pad_const [Const]
2018-11-27 08:20:43.749288: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f6c98 :: fc1/Reshape/shape [Const]
2018-11-27 08:20:43.749296: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f6d10 :: squash/Const [Const]
2018-11-27 08:20:43.749302: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f6d88 :: fc2/Const [Const]
2018-11-27 08:20:43.749309: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f6e00 :: reshape/Reshape [Reshape]
2018-11-27 08:20:43.749316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f6eb8 :: conv1/Conv2D [Conv2D]
2018-11-27 08:20:43.749324: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f6f70 :: conv1/Square [Square]
2018-11-27 08:20:43.749331: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f7008 :: conv1/Pad [Pad]
2018-11-27 08:20:43.749338: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f70c0 :: fc1/Reshape [Reshape]
2018-11-27 08:20:43.749345: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f7178 :: fc1/MatMul [MatMul]
2018-11-27 08:20:43.749352: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f7230 :: fc1/Square [Square]
2018-11-27 08:20:43.749359: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 0: 0x44f72c8 :: fc2/MatMul [MatMul]
2018-11-27 08:20:43.749422: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 08:20:43.749468: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 0 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 08:20:43.749500: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 0 to fc2/Print[0] in -1, datatype: 1
2018-11-27 08:20:43.749535: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 0 to fc2/Print[1] in -1, datatype: 1
2018-11-27 08:20:43.749546: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 0, datatype: 1
2018-11-27 08:20:43.751297: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 08:20:43.751318: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T16:20:43z src/seal/ckks/he_seal_ckks_backend.cpp 66	Using SEAL CKKS config with 7 40-bit coefficients
[INFO] 2018-11-27T16:20:45z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 08:20:46.066290: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 0
2018-11-27 08:20:46.066371: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 08:20:46.066386: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 0
2018-11-27 08:20:46.066400: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_0
2018-11-27 08:20:46.066548: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 08:20:46.066655: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 08:20:46.066680: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 08:20:46.066704: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 08:20:46.066751: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 08:20:46.066799: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 08:20:46.066819: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 08:20:46.066826: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 08:20:46.066832: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 08:20:46.066837: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 08:20:46.066852: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 08:20:46.066884: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 08:20:46.066891: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 08:20:46.066898: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 08:20:46.066907: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 08:20:46.066935: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 08:20:46.066947: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 08:20:46.066954: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 08:20:46.067064: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 08:20:46.067099: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 08:20:46.067142: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 08:20:46.067177: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 08:20:46.067199: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 08:20:46.067208: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 08:20:46.067215: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 08:20:46.067276: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 08:20:46.067317: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 08:20:46.067330: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 08:20:46.067343: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 08:20:46.067377: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 08:20:46.068145: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 08:20:46.068200: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 08:20:46.068237: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 08:20:46.068278: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 08:20:46.068419: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 0
2018-11-27 08:20:46.068446: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 0
[INFO] 2018-11-27T16:20:46z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 08:20:46.357786: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 0
[INFO] 2018-11-27T16:20:46z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 08:20:46.386499: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 0
2018-11-27 08:20:46.386514: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 0
[INFO] 2018-11-27T16:20:46z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T16:20:46z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T16:20:53z src/he_backend.cpp 319	[ Parameter_0 ]
[INFO] 2018-11-27T16:20:53z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T16:20:53z src/he_backend.cpp 319	[ Constant_17 ]
[INFO] 2018-11-27T16:20:54z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:20:54z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:20:54z src/he_backend.cpp 395	Constant_17 took 0s
[INFO] 2018-11-27T16:20:54z src/he_backend.cpp 319	[ Constant_14 ]
[INFO] 2018-11-27T16:20:54z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:20:54z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 395	Constant_14 took 5s
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 319	[ Constant_10 ]
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 395	Constant_10 took 0s
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 319	[ Constant_3 ]
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 395	Constant_3 took 0s
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 319	[ Reshape_2 ]
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 395	Reshape_2 took 0s
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 319	[ Reshape_5 ]
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 395	Reshape_5 took 0s
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 319	[ Reshape_4 ]
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 395	Reshape_4 took 0s
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 319	[ Convolution_6 ]
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:21:00z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:21:09z src/he_backend.cpp 395	Convolution_6 took 8s
[INFO] 2018-11-27T16:21:09z src/he_backend.cpp 319	[ Reshape_7 ]
[INFO] 2018-11-27T16:21:09z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:21:09z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:21:09z src/he_backend.cpp 395	Reshape_7 took 0s
[INFO] 2018-11-27T16:21:09z src/he_backend.cpp 319	[ Multiply_8 ]
[INFO] 2018-11-27T16:21:09z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:21:09z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:21:11z src/he_backend.cpp 395	Multiply_8 took 2s
[INFO] 2018-11-27T16:21:11z src/he_backend.cpp 319	[ Pad_11 ]
[INFO] 2018-11-27T16:21:11z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:21:11z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:21:11z src/he_backend.cpp 395	Pad_11 took 0s
[INFO] 2018-11-27T16:21:11z src/he_backend.cpp 319	[ Reshape_13 ]
[INFO] 2018-11-27T16:21:11z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:21:11z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:21:11z src/he_backend.cpp 395	Reshape_13 took 0s
[INFO] 2018-11-27T16:21:11z src/he_backend.cpp 319	[ Dot_15 ]
[INFO] 2018-11-27T16:21:11z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:21:11z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:21:11z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T16:21:52z src/he_backend.cpp 395	Dot_15 took 41s
[INFO] 2018-11-27T16:21:52z src/he_backend.cpp 319	[ Multiply_16 ]
[INFO] 2018-11-27T16:21:52z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:21:52z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:21:53z src/he_backend.cpp 395	Multiply_16 took 0s
[INFO] 2018-11-27T16:21:53z src/he_backend.cpp 319	[ Dot_18 ]
[INFO] 2018-11-27T16:21:53z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:21:53z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:21:53z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T16:21:53z src/he_backend.cpp 395	Dot_18 took 0s
[INFO] 2018-11-27T16:21:53z src/he_backend.cpp 319	[ Result_19 ]
[INFO] 2018-11-27T16:21:53z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:21:53z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:21:53z src/he_backend.cpp 395	Result_19 took 0s
2018-11-27 08:21:53.676548: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 0
2018-11-27 08:21:53.935654: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 0
Result
[[-1.71357977 -3.75100422 6.57461691 6.78587389 -3.69602489 -3.98765278 -15.4481697 17.4318256 1.80505764 8.17802]]
total time warmup: 70.20032215118408
2018-11-27 08:21:53.950228: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 08:21:53.950258: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 08:21:53.950270: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 08:21:53.950280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 08:21:53.950290: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 08:21:53.950300: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 08:21:53.950313: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 08:21:53.950323: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 08:21:53.950339: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 08:21:53.950352: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 08:21:53.950362: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 08:21:53.950373: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 08:21:53.950383: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 08:21:53.950392: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 08:21:53.950401: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 08:21:53.950409: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 08:21:53.950417: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 08:21:53.950428: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 08:21:53.950435: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 08:21:53.950445: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:21:53.950490: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 08:21:53.950508: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 08:21:53.950517: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 08:21:53.950526: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 08:21:53.950536: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 08:21:53.950545: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 08:21:53.950554: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 08:21:53.950563: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 08:21:53.950573: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 08:21:53.950583: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 08:21:53.950592: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 08:21:53.950601: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 08:21:53.950610: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 08:21:53.950620: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 08:21:53.950629: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 08:21:53.950638: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 08:21:53.950649: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:21:53.950725: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 08:21:53.950749: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 08:21:53.950767: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 08:21:53.950782: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 08:21:53.950798: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 08:21:53.950816: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 08:21:53.950832: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 08:21:53.950854: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 08:21:53.950869: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 08:21:53.950893: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 08:21:53.950909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 08:21:53.950931: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 08:21:53.950949: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 08:21:53.950964: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 08:21:53.950987: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:21:53.950996: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:21:53.951005: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:21:53.951014: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:21:53.951037: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:21:53.951046: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:21:53.951054: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:21:53.951063: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:21:53.951069: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 08:21:53.951076: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 08:21:53.951105: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c3670 :: reshape/Reshape/shape [Const]
2018-11-27 08:21:53.951113: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c36e8 :: conv1/Const [Const]
2018-11-27 08:21:53.951121: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c3760 :: conv1/pad_const [Const]
2018-11-27 08:21:53.951141: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c37d8 :: fc1/Reshape/shape [Const]
2018-11-27 08:21:53.951148: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c3850 :: squash/Const [Const]
2018-11-27 08:21:53.951155: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c38c8 :: fc2/Const [Const]
2018-11-27 08:21:53.951162: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c3940 :: reshape/Reshape [Reshape]
2018-11-27 08:21:53.951169: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c39f8 :: conv1/Conv2D [Conv2D]
2018-11-27 08:21:53.951176: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c3ab0 :: conv1/Square [Square]
2018-11-27 08:21:53.951183: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c3b48 :: conv1/Pad [Pad]
2018-11-27 08:21:53.951190: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c3c00 :: fc1/Reshape [Reshape]
2018-11-27 08:21:53.951197: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c3cb8 :: fc1/MatMul [MatMul]
2018-11-27 08:21:53.951204: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c3d70 :: fc1/Square [Square]
2018-11-27 08:21:53.951211: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 1: 0x97c3e08 :: fc2/MatMul [MatMul]
2018-11-27 08:21:53.951274: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 08:21:53.951321: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 1 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 08:21:53.951352: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 1 to fc2/Print[0] in -1, datatype: 1
2018-11-27 08:21:53.951385: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 1 to fc2/Print[1] in -1, datatype: 1
2018-11-27 08:21:53.951396: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 1, datatype: 1
2018-11-27 08:21:53.952437: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 08:21:53.952457: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T16:21:56z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 08:21:56.240869: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 1
2018-11-27 08:21:56.240934: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 08:21:56.240944: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 1
2018-11-27 08:21:56.240952: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_1
2018-11-27 08:21:56.241034: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 08:21:56.241110: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 08:21:56.241132: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 08:21:56.241156: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 08:21:56.241195: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 08:21:56.241243: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 08:21:56.241261: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 08:21:56.241268: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 08:21:56.241273: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 08:21:56.241279: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 08:21:56.241291: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 08:21:56.241323: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 08:21:56.241331: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 08:21:56.241338: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 08:21:56.241346: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 08:21:56.241371: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 08:21:56.241399: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 08:21:56.241407: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 08:21:56.241509: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 08:21:56.241541: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 08:21:56.241586: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 08:21:56.241618: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 08:21:56.241643: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 08:21:56.241652: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 08:21:56.241659: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 08:21:56.241712: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 08:21:56.241741: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 08:21:56.241754: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 08:21:56.241767: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 08:21:56.241801: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 08:21:56.242595: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 08:21:56.242642: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 08:21:56.242679: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 08:21:56.242718: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 08:21:56.242841: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 1
2018-11-27 08:21:56.242861: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 1
[INFO] 2018-11-27T16:21:56z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 08:21:56.298154: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 1
[INFO] 2018-11-27T16:21:56z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 08:21:56.298612: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 1
2018-11-27 08:21:56.298628: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 1
[INFO] 2018-11-27T16:21:56z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T16:21:56z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T16:22:04z src/he_backend.cpp 319	[ Parameter_20 ]
[INFO] 2018-11-27T16:22:04z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T16:22:04z src/he_backend.cpp 319	[ Constant_37 ]
[INFO] 2018-11-27T16:22:04z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:22:04z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:22:04z src/he_backend.cpp 395	Constant_37 took 0s
[INFO] 2018-11-27T16:22:04z src/he_backend.cpp 319	[ Constant_34 ]
[INFO] 2018-11-27T16:22:04z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:22:04z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 395	Constant_34 took 3s
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 319	[ Constant_30 ]
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 395	Constant_30 took 0s
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 319	[ Constant_23 ]
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 395	Constant_23 took 0s
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 319	[ Reshape_22 ]
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 395	Reshape_22 took 0s
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 319	[ Reshape_25 ]
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 395	Reshape_25 took 0s
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 319	[ Reshape_24 ]
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 395	Reshape_24 took 0s
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 319	[ Convolution_26 ]
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:22:07z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:22:17z src/he_backend.cpp 395	Convolution_26 took 9s
[INFO] 2018-11-27T16:22:17z src/he_backend.cpp 319	[ Reshape_27 ]
[INFO] 2018-11-27T16:22:17z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:22:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:22:17z src/he_backend.cpp 395	Reshape_27 took 0s
[INFO] 2018-11-27T16:22:17z src/he_backend.cpp 319	[ Multiply_28 ]
[INFO] 2018-11-27T16:22:17z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:22:17z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:22:18z src/he_backend.cpp 395	Multiply_28 took 0s
[INFO] 2018-11-27T16:22:18z src/he_backend.cpp 319	[ Pad_31 ]
[INFO] 2018-11-27T16:22:18z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:22:18z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:22:18z src/he_backend.cpp 395	Pad_31 took 0s
[INFO] 2018-11-27T16:22:18z src/he_backend.cpp 319	[ Reshape_33 ]
[INFO] 2018-11-27T16:22:18z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:22:18z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:22:18z src/he_backend.cpp 395	Reshape_33 took 0s
[INFO] 2018-11-27T16:22:18z src/he_backend.cpp 319	[ Dot_35 ]
[INFO] 2018-11-27T16:22:18z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:22:18z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:22:18z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 395	Dot_35 took 30s
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 319	[ Multiply_36 ]
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 395	Multiply_36 took 0s
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 319	[ Dot_38 ]
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 395	Dot_38 took 0s
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 319	[ Result_39 ]
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:22:48z src/he_backend.cpp 395	Result_39 took 0s
2018-11-27 08:22:48.980954: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 1
2018-11-27 08:22:49.196810: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 1
Result
[[-1.71703207 -3.75210071 6.57676 6.78557968 -3.69396329 -3.98744535 -15.4475145 17.4313 1.80802059 8.18037891]]
total time trial 1: 55.25440216064453
2018-11-27 08:22:49.207516: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 08:22:49.207565: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 08:22:49.207575: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 08:22:49.207583: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 08:22:49.207591: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 08:22:49.207601: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 08:22:49.207616: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 08:22:49.207625: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 08:22:49.207652: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 08:22:49.207666: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 08:22:49.207676: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 08:22:49.207688: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 08:22:49.207697: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 08:22:49.207705: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 08:22:49.207714: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 08:22:49.207720: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 08:22:49.207728: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 08:22:49.207734: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 08:22:49.207741: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 08:22:49.207747: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:22:49.207811: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 08:22:49.207831: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 08:22:49.207840: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 08:22:49.207848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 08:22:49.207857: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 08:22:49.207866: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 08:22:49.207874: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 08:22:49.207882: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 08:22:49.207891: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 08:22:49.207900: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 08:22:49.207908: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 08:22:49.207917: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 08:22:49.207925: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 08:22:49.207934: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 08:22:49.207942: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 08:22:49.207950: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 08:22:49.207960: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:22:49.208043: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 08:22:49.208068: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 08:22:49.208085: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 08:22:49.208099: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 08:22:49.208113: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 08:22:49.208130: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 08:22:49.208144: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 08:22:49.208163: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 08:22:49.208177: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 08:22:49.208199: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 08:22:49.208213: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 08:22:49.208233: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 08:22:49.208248: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 08:22:49.208262: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 08:22:49.208283: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:22:49.208291: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:22:49.208299: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:22:49.208307: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:22:49.208328: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:22:49.208335: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:22:49.208343: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:22:49.208351: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:22:49.208367: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 08:22:49.208373: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 08:22:49.208408: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d5000 :: reshape/Reshape/shape [Const]
2018-11-27 08:22:49.208416: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d5078 :: conv1/Const [Const]
2018-11-27 08:22:49.208423: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d50f0 :: conv1/pad_const [Const]
2018-11-27 08:22:49.208433: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d5168 :: fc1/Reshape/shape [Const]
2018-11-27 08:22:49.208439: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d51e0 :: squash/Const [Const]
2018-11-27 08:22:49.208447: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d5258 :: fc2/Const [Const]
2018-11-27 08:22:49.208453: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d52d0 :: reshape/Reshape [Reshape]
2018-11-27 08:22:49.208461: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d5388 :: conv1/Conv2D [Conv2D]
2018-11-27 08:22:49.208467: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d5440 :: conv1/Square [Square]
2018-11-27 08:22:49.208474: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d54d8 :: conv1/Pad [Pad]
2018-11-27 08:22:49.208482: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d5590 :: fc1/Reshape [Reshape]
2018-11-27 08:22:49.208489: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d5648 :: fc1/MatMul [MatMul]
2018-11-27 08:22:49.208496: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d5700 :: fc1/Square [Square]
2018-11-27 08:22:49.208503: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 2: 0x97d5798 :: fc2/MatMul [MatMul]
2018-11-27 08:22:49.208566: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 08:22:49.208620: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 2 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 08:22:49.208654: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 2 to fc2/Print[0] in -1, datatype: 1
2018-11-27 08:22:49.208697: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 2 to fc2/Print[1] in -1, datatype: 1
2018-11-27 08:22:49.208708: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 2, datatype: 1
2018-11-27 08:22:49.210873: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 08:22:49.210895: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T16:22:51z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 08:22:51.587766: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 2
2018-11-27 08:22:51.587836: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 08:22:51.587850: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 2
2018-11-27 08:22:51.587857: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_2
2018-11-27 08:22:51.587965: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 08:22:51.588047: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 08:22:51.588070: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 08:22:51.588096: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 08:22:51.588136: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 08:22:51.588186: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 08:22:51.588206: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 08:22:51.588213: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 08:22:51.588219: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 08:22:51.588224: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 08:22:51.588236: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 08:22:51.588266: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 08:22:51.588273: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 08:22:51.588280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 08:22:51.588288: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 08:22:51.588314: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 08:22:51.588326: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 08:22:51.588333: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 08:22:51.588442: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 08:22:51.588476: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 08:22:51.588520: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 08:22:51.588554: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 08:22:51.588578: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 08:22:51.588587: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 08:22:51.588594: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 08:22:51.588648: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 08:22:51.588677: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 08:22:51.588690: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 08:22:51.588703: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 08:22:51.588735: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 08:22:51.589363: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 08:22:51.589414: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 08:22:51.589450: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 08:22:51.589492: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 08:22:51.589617: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 2
2018-11-27 08:22:51.589637: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 2
[INFO] 2018-11-27T16:22:51z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 08:22:51.638912: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 2
[INFO] 2018-11-27T16:22:51z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 08:22:51.639433: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 2
2018-11-27 08:22:51.639448: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 2
[INFO] 2018-11-27T16:22:51z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T16:22:51z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T16:22:59z src/he_backend.cpp 319	[ Parameter_40 ]
[INFO] 2018-11-27T16:22:59z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T16:22:59z src/he_backend.cpp 319	[ Constant_57 ]
[INFO] 2018-11-27T16:22:59z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:22:59z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:22:59z src/he_backend.cpp 395	Constant_57 took 0s
[INFO] 2018-11-27T16:22:59z src/he_backend.cpp 319	[ Constant_54 ]
[INFO] 2018-11-27T16:22:59z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:22:59z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 395	Constant_54 took 3s
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 319	[ Constant_50 ]
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 395	Constant_50 took 0s
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 319	[ Constant_43 ]
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 395	Constant_43 took 0s
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 319	[ Reshape_42 ]
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 395	Reshape_42 took 0s
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 319	[ Reshape_45 ]
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 395	Reshape_45 took 0s
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 319	[ Reshape_44 ]
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 395	Reshape_44 took 0s
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 319	[ Convolution_46 ]
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:23:02z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:23:11z src/he_backend.cpp 395	Convolution_46 took 9s
[INFO] 2018-11-27T16:23:11z src/he_backend.cpp 319	[ Reshape_47 ]
[INFO] 2018-11-27T16:23:11z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:23:11z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:23:11z src/he_backend.cpp 395	Reshape_47 took 0s
[INFO] 2018-11-27T16:23:11z src/he_backend.cpp 319	[ Multiply_48 ]
[INFO] 2018-11-27T16:23:11z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:23:11z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:23:12z src/he_backend.cpp 395	Multiply_48 took 0s
[INFO] 2018-11-27T16:23:12z src/he_backend.cpp 319	[ Pad_51 ]
[INFO] 2018-11-27T16:23:12z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:23:12z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:23:12z src/he_backend.cpp 395	Pad_51 took 0s
[INFO] 2018-11-27T16:23:12z src/he_backend.cpp 319	[ Reshape_53 ]
[INFO] 2018-11-27T16:23:12z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:23:12z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:23:12z src/he_backend.cpp 395	Reshape_53 took 0s
[INFO] 2018-11-27T16:23:12z src/he_backend.cpp 319	[ Dot_55 ]
[INFO] 2018-11-27T16:23:12z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:23:12z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:23:12z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T16:23:40z src/he_backend.cpp 395	Dot_55 took 28s
[INFO] 2018-11-27T16:23:40z src/he_backend.cpp 319	[ Multiply_56 ]
[INFO] 2018-11-27T16:23:40z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:23:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:23:41z src/he_backend.cpp 395	Multiply_56 took 0s
[INFO] 2018-11-27T16:23:41z src/he_backend.cpp 319	[ Dot_58 ]
[INFO] 2018-11-27T16:23:41z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:23:41z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:23:41z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T16:23:41z src/he_backend.cpp 395	Dot_58 took 0s
[INFO] 2018-11-27T16:23:41z src/he_backend.cpp 319	[ Result_59 ]
[INFO] 2018-11-27T16:23:41z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:23:41z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:23:41z src/he_backend.cpp 395	Result_59 took 0s
2018-11-27 08:23:41.880300: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 2
2018-11-27 08:23:42.111185: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 2
Result
[[-1.71773028 -3.75272632 6.57749414 6.78606558 -3.69405413 -3.98743629 -15.4482031 17.432085 1.80871773 8.18087196]]
total time trial 2: 52.911081314086914
2018-11-27 08:23:42.122490: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 08:23:42.122523: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 08:23:42.122536: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 08:23:42.122546: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 08:23:42.122556: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 08:23:42.122569: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 08:23:42.122591: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 08:23:42.122603: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 08:23:42.122618: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 08:23:42.122635: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 08:23:42.122647: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 08:23:42.122662: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 08:23:42.122673: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 08:23:42.122685: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 08:23:42.122695: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 08:23:42.122702: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 08:23:42.122712: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 08:23:42.122719: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 08:23:42.122727: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 08:23:42.122734: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:23:42.122791: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 08:23:42.122818: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 08:23:42.122829: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 08:23:42.122839: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 08:23:42.122850: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 08:23:42.122860: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 08:23:42.122871: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 08:23:42.122881: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 08:23:42.122892: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 08:23:42.122902: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 08:23:42.122912: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 08:23:42.122923: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 08:23:42.122933: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 08:23:42.122943: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 08:23:42.122953: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 08:23:42.122964: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 08:23:42.122977: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:23:42.123062: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 08:23:42.123086: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 08:23:42.123105: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 08:23:42.123120: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 08:23:42.123137: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 08:23:42.123155: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 08:23:42.123171: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 08:23:42.123193: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 08:23:42.123209: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 08:23:42.123233: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 08:23:42.123249: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 08:23:42.123271: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 08:23:42.123289: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 08:23:42.123305: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 08:23:42.123327: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:23:42.123337: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:23:42.123346: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:23:42.123355: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:23:42.123379: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:23:42.123388: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:23:42.123398: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:23:42.123407: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:23:42.123414: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 08:23:42.123420: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 08:23:42.123434: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d1540 :: reshape/Reshape/shape [Const]
2018-11-27 08:23:42.123444: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d15b8 :: conv1/Const [Const]
2018-11-27 08:23:42.123452: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d1630 :: conv1/pad_const [Const]
2018-11-27 08:23:42.123460: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d16a8 :: fc1/Reshape/shape [Const]
2018-11-27 08:23:42.123468: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d1720 :: squash/Const [Const]
2018-11-27 08:23:42.123477: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d1798 :: fc2/Const [Const]
2018-11-27 08:23:42.123485: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d1810 :: reshape/Reshape [Reshape]
2018-11-27 08:23:42.123493: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d18c8 :: conv1/Conv2D [Conv2D]
2018-11-27 08:23:42.123501: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d1980 :: conv1/Square [Square]
2018-11-27 08:23:42.123510: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d1a18 :: conv1/Pad [Pad]
2018-11-27 08:23:42.123518: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d1ad0 :: fc1/Reshape [Reshape]
2018-11-27 08:23:42.123526: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d1b88 :: fc1/MatMul [MatMul]
2018-11-27 08:23:42.123534: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d1c40 :: fc1/Square [Square]
2018-11-27 08:23:42.123542: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 3: 0x97d1cd8 :: fc2/MatMul [MatMul]
2018-11-27 08:23:42.123607: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 08:23:42.123658: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 3 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 08:23:42.123692: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 3 to fc2/Print[0] in -1, datatype: 1
2018-11-27 08:23:42.123732: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 3 to fc2/Print[1] in -1, datatype: 1
2018-11-27 08:23:42.123744: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 3, datatype: 1
2018-11-27 08:23:42.125682: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 08:23:42.125719: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T16:23:44z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 08:23:44.518830: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 3
2018-11-27 08:23:44.518891: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 08:23:44.518901: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 3
2018-11-27 08:23:44.518909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_3
2018-11-27 08:23:44.518999: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 08:23:44.519074: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 08:23:44.519097: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 08:23:44.519122: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 08:23:44.519162: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 08:23:44.519210: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 08:23:44.519229: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 08:23:44.519236: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 08:23:44.519242: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 08:23:44.519248: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 08:23:44.519259: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 08:23:44.519290: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 08:23:44.519297: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 08:23:44.519304: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 08:23:44.519313: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 08:23:44.519339: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 08:23:44.519351: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 08:23:44.519358: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 08:23:44.519455: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 08:23:44.519487: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 08:23:44.519531: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 08:23:44.519566: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 08:23:44.519589: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 08:23:44.519598: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 08:23:44.519605: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 08:23:44.519657: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 08:23:44.519686: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 08:23:44.519699: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 08:23:44.519712: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 08:23:44.519744: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 08:23:44.520508: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 08:23:44.520560: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 08:23:44.520597: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 08:23:44.520643: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 08:23:44.520764: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 3
2018-11-27 08:23:44.520783: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 3
[INFO] 2018-11-27T16:23:44z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 08:23:44.575525: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 3
[INFO] 2018-11-27T16:23:44z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 08:23:44.575910: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 3
2018-11-27 08:23:44.575925: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 3
[INFO] 2018-11-27T16:23:44z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T16:23:44z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T16:23:52z src/he_backend.cpp 319	[ Parameter_60 ]
[INFO] 2018-11-27T16:23:52z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T16:23:52z src/he_backend.cpp 319	[ Constant_77 ]
[INFO] 2018-11-27T16:23:52z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:23:52z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:23:52z src/he_backend.cpp 395	Constant_77 took 0s
[INFO] 2018-11-27T16:23:52z src/he_backend.cpp 319	[ Constant_74 ]
[INFO] 2018-11-27T16:23:52z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:23:52z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 395	Constant_74 took 3s
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 319	[ Constant_70 ]
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 395	Constant_70 took 0s
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 319	[ Constant_63 ]
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 395	Constant_63 took 0s
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 319	[ Reshape_62 ]
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 395	Reshape_62 took 0s
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 319	[ Reshape_65 ]
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 395	Reshape_65 took 0s
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 319	[ Reshape_64 ]
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 395	Reshape_64 took 0s
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 319	[ Convolution_66 ]
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:23:55z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:04z src/he_backend.cpp 395	Convolution_66 took 8s
[INFO] 2018-11-27T16:24:04z src/he_backend.cpp 319	[ Reshape_67 ]
[INFO] 2018-11-27T16:24:04z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:24:04z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:04z src/he_backend.cpp 395	Reshape_67 took 0s
[INFO] 2018-11-27T16:24:04z src/he_backend.cpp 319	[ Multiply_68 ]
[INFO] 2018-11-27T16:24:04z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:24:04z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:05z src/he_backend.cpp 395	Multiply_68 took 0s
[INFO] 2018-11-27T16:24:05z src/he_backend.cpp 319	[ Pad_71 ]
[INFO] 2018-11-27T16:24:05z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:24:05z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:05z src/he_backend.cpp 395	Pad_71 took 0s
[INFO] 2018-11-27T16:24:05z src/he_backend.cpp 319	[ Reshape_73 ]
[INFO] 2018-11-27T16:24:05z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:24:05z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:05z src/he_backend.cpp 395	Reshape_73 took 0s
[INFO] 2018-11-27T16:24:05z src/he_backend.cpp 319	[ Dot_75 ]
[INFO] 2018-11-27T16:24:05z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:24:05z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:05z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 395	Dot_75 took 27s
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 319	[ Multiply_76 ]
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 395	Multiply_76 took 0s
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 319	[ Dot_78 ]
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 395	Dot_78 took 0s
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 319	[ Result_79 ]
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:24:33z src/he_backend.cpp 395	Result_79 took 0s
2018-11-27 08:24:33.741453: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 3
2018-11-27 08:24:33.953625: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 3
Result
[[-1.71564448 -3.75187802 6.57606 6.78599119 -3.6950655 -3.9875443 -15.4482183 17.4319897 1.80688274 8.17943764]]
total time trial 3: 51.83791255950928
2018-11-27 08:24:33.964115: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 08:24:33.964159: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 08:24:33.964170: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 08:24:33.964179: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 08:24:33.964187: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 08:24:33.964197: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 08:24:33.964211: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 08:24:33.964220: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 08:24:33.964232: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 08:24:33.964245: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 08:24:33.964255: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 08:24:33.964267: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 08:24:33.964275: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 08:24:33.964284: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 08:24:33.964293: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 08:24:33.964300: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 08:24:33.964308: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 08:24:33.964314: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 08:24:33.964321: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 08:24:33.964327: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:24:33.964398: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 08:24:33.964419: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 08:24:33.964428: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 08:24:33.964436: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 08:24:33.964446: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 08:24:33.964454: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 08:24:33.964463: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 08:24:33.964471: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 08:24:33.964481: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 08:24:33.964489: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 08:24:33.964498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 08:24:33.964506: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 08:24:33.964515: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 08:24:33.964523: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 08:24:33.964532: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 08:24:33.964541: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 08:24:33.964551: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:24:33.964635: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 08:24:33.964660: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 08:24:33.964678: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 08:24:33.964692: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 08:24:33.964707: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 08:24:33.964723: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 08:24:33.964737: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 08:24:33.964757: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 08:24:33.964771: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 08:24:33.964794: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 08:24:33.964808: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 08:24:33.964828: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 08:24:33.964844: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 08:24:33.964857: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 08:24:33.964878: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:24:33.964887: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:24:33.964895: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:24:33.964903: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:24:33.964924: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:24:33.964932: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:24:33.964940: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:24:33.964948: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:24:33.964954: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 08:24:33.964960: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 08:24:33.964977: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97cce90 :: reshape/Reshape/shape [Const]
2018-11-27 08:24:33.964985: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97ccf08 :: conv1/Const [Const]
2018-11-27 08:24:33.964992: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97ccf80 :: conv1/pad_const [Const]
2018-11-27 08:24:33.964999: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97ccff8 :: fc1/Reshape/shape [Const]
2018-11-27 08:24:33.965006: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97cd070 :: squash/Const [Const]
2018-11-27 08:24:33.965013: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97cd0e8 :: fc2/Const [Const]
2018-11-27 08:24:33.965020: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97cd160 :: reshape/Reshape [Reshape]
2018-11-27 08:24:33.965027: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97cd218 :: conv1/Conv2D [Conv2D]
2018-11-27 08:24:33.965034: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97cd2d0 :: conv1/Square [Square]
2018-11-27 08:24:33.965041: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97cd368 :: conv1/Pad [Pad]
2018-11-27 08:24:33.965048: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97cd420 :: fc1/Reshape [Reshape]
2018-11-27 08:24:33.965055: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97cd4d8 :: fc1/MatMul [MatMul]
2018-11-27 08:24:33.965062: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97cd590 :: fc1/Square [Square]
2018-11-27 08:24:33.965069: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 4: 0x97cd628 :: fc2/MatMul [MatMul]
2018-11-27 08:24:33.965132: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 08:24:33.965184: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 4 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 08:24:33.965219: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 4 to fc2/Print[0] in -1, datatype: 1
2018-11-27 08:24:33.965261: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 4 to fc2/Print[1] in -1, datatype: 1
2018-11-27 08:24:33.965272: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 4, datatype: 1
2018-11-27 08:24:33.967173: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 08:24:33.967238: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T16:24:36z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 08:24:36.260954: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 4
2018-11-27 08:24:36.261016: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 08:24:36.261028: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 4
2018-11-27 08:24:36.261036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_4
2018-11-27 08:24:36.261134: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 08:24:36.261212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 08:24:36.261236: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 08:24:36.261258: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 08:24:36.261297: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 08:24:36.261346: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 08:24:36.261363: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 08:24:36.261371: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 08:24:36.261376: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 08:24:36.261381: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 08:24:36.261393: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 08:24:36.261423: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 08:24:36.261430: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 08:24:36.261437: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 08:24:36.261445: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 08:24:36.261486: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 08:24:36.261498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 08:24:36.261505: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 08:24:36.261600: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 08:24:36.261633: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 08:24:36.261675: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 08:24:36.261709: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 08:24:36.261732: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 08:24:36.261741: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 08:24:36.261748: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 08:24:36.261800: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 08:24:36.261829: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 08:24:36.261842: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 08:24:36.261854: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 08:24:36.261887: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 08:24:36.262530: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 08:24:36.262578: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 08:24:36.262614: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 08:24:36.262654: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 08:24:36.262773: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 4
2018-11-27 08:24:36.262793: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 4
[INFO] 2018-11-27T16:24:36z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 08:24:36.303225: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 4
[INFO] 2018-11-27T16:24:36z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 08:24:36.303800: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 4
2018-11-27 08:24:36.303813: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 4
[INFO] 2018-11-27T16:24:36z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T16:24:36z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T16:24:44z src/he_backend.cpp 319	[ Parameter_80 ]
[INFO] 2018-11-27T16:24:44z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T16:24:44z src/he_backend.cpp 319	[ Constant_97 ]
[INFO] 2018-11-27T16:24:44z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:24:44z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:24:44z src/he_backend.cpp 395	Constant_97 took 0s
[INFO] 2018-11-27T16:24:44z src/he_backend.cpp 319	[ Constant_94 ]
[INFO] 2018-11-27T16:24:44z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:24:44z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 395	Constant_94 took 3s
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 319	[ Constant_90 ]
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 395	Constant_90 took 0s
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 319	[ Constant_83 ]
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 395	Constant_83 took 0s
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 319	[ Reshape_82 ]
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 395	Reshape_82 took 0s
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 319	[ Reshape_85 ]
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 395	Reshape_85 took 0s
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 319	[ Reshape_84 ]
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 395	Reshape_84 took 0s
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 319	[ Convolution_86 ]
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:24:47z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:56z src/he_backend.cpp 395	Convolution_86 took 8s
[INFO] 2018-11-27T16:24:56z src/he_backend.cpp 319	[ Reshape_87 ]
[INFO] 2018-11-27T16:24:56z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:24:56z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:56z src/he_backend.cpp 395	Reshape_87 took 0s
[INFO] 2018-11-27T16:24:56z src/he_backend.cpp 319	[ Multiply_88 ]
[INFO] 2018-11-27T16:24:56z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:24:56z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:57z src/he_backend.cpp 395	Multiply_88 took 0s
[INFO] 2018-11-27T16:24:57z src/he_backend.cpp 319	[ Pad_91 ]
[INFO] 2018-11-27T16:24:57z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:24:57z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:57z src/he_backend.cpp 395	Pad_91 took 0s
[INFO] 2018-11-27T16:24:57z src/he_backend.cpp 319	[ Reshape_93 ]
[INFO] 2018-11-27T16:24:57z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:24:57z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:57z src/he_backend.cpp 395	Reshape_93 took 0s
[INFO] 2018-11-27T16:24:57z src/he_backend.cpp 319	[ Dot_95 ]
[INFO] 2018-11-27T16:24:57z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:24:57z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:24:57z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T16:25:25z src/he_backend.cpp 395	Dot_95 took 28s
[INFO] 2018-11-27T16:25:25z src/he_backend.cpp 319	[ Multiply_96 ]
[INFO] 2018-11-27T16:25:25z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:25:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:25:25z src/he_backend.cpp 395	Multiply_96 took 0s
[INFO] 2018-11-27T16:25:25z src/he_backend.cpp 319	[ Dot_98 ]
[INFO] 2018-11-27T16:25:25z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:25:25z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:25:25z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T16:25:26z src/he_backend.cpp 395	Dot_98 took 0s
[INFO] 2018-11-27T16:25:26z src/he_backend.cpp 319	[ Result_99 ]
[INFO] 2018-11-27T16:25:26z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:25:26z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:25:26z src/he_backend.cpp 395	Result_99 took 0s
2018-11-27 08:25:26.354638: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 4
2018-11-27 08:25:26.560385: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 4
Result
[[-1.71776271 -3.75257492 6.57739258 6.78584909 -3.69383669 -3.98741961 -15.4478703 17.4317245 1.8087039 8.18089104]]
total time trial 4: 52.60347080230713
2018-11-27 08:25:26.571001: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 08:25:26.571030: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 08:25:26.571039: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 08:25:26.571048: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 08:25:26.571055: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 08:25:26.571064: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 08:25:26.571078: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 08:25:26.571091: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 08:25:26.571103: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 08:25:26.571116: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 08:25:26.571125: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 08:25:26.571136: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 08:25:26.571154: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 08:25:26.571163: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 08:25:26.571171: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 08:25:26.571177: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 08:25:26.571185: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 08:25:26.571191: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 08:25:26.571198: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 08:25:26.571204: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:25:26.571251: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 08:25:26.571268: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 08:25:26.571277: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 08:25:26.571285: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 08:25:26.571295: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 08:25:26.571303: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 08:25:26.571312: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 08:25:26.571320: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 08:25:26.571329: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 08:25:26.571338: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 08:25:26.571347: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 08:25:26.571360: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 08:25:26.571369: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 08:25:26.571377: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 08:25:26.571386: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 08:25:26.571395: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 08:25:26.571404: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:25:26.571476: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 08:25:26.571498: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 08:25:26.571515: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 08:25:26.571529: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 08:25:26.571544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 08:25:26.571560: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 08:25:26.571574: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 08:25:26.571594: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 08:25:26.571608: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 08:25:26.571631: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 08:25:26.571645: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 08:25:26.571665: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 08:25:26.571681: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 08:25:26.571695: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 08:25:26.571716: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:25:26.571724: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:25:26.571733: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:25:26.571740: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:25:26.571762: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:25:26.571770: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:25:26.571779: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:25:26.571786: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:25:26.571792: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 08:25:26.571798: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 08:25:26.571812: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c79e0 :: reshape/Reshape/shape [Const]
2018-11-27 08:25:26.571820: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c7a58 :: conv1/Const [Const]
2018-11-27 08:25:26.571827: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c7ad0 :: conv1/pad_const [Const]
2018-11-27 08:25:26.571834: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c7b48 :: fc1/Reshape/shape [Const]
2018-11-27 08:25:26.571841: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c7bc0 :: squash/Const [Const]
2018-11-27 08:25:26.571848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c7c38 :: fc2/Const [Const]
2018-11-27 08:25:26.571855: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c7cb0 :: reshape/Reshape [Reshape]
2018-11-27 08:25:26.571862: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c7d68 :: conv1/Conv2D [Conv2D]
2018-11-27 08:25:26.571869: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c7e20 :: conv1/Square [Square]
2018-11-27 08:25:26.571876: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c7eb8 :: conv1/Pad [Pad]
2018-11-27 08:25:26.571883: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c7f70 :: fc1/Reshape [Reshape]
2018-11-27 08:25:26.571890: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c8028 :: fc1/MatMul [MatMul]
2018-11-27 08:25:26.571897: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c80e0 :: fc1/Square [Square]
2018-11-27 08:25:26.571904: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 5: 0x97c8178 :: fc2/MatMul [MatMul]
2018-11-27 08:25:26.571969: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 08:25:26.572017: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 5 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 08:25:26.572050: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 5 to fc2/Print[0] in -1, datatype: 1
2018-11-27 08:25:26.572084: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 5 to fc2/Print[1] in -1, datatype: 1
2018-11-27 08:25:26.572095: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 5, datatype: 1
2018-11-27 08:25:26.573701: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 08:25:26.573721: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T16:25:28z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 08:25:28.888290: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 5
2018-11-27 08:25:28.888386: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 08:25:28.888399: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 5
2018-11-27 08:25:28.888406: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_5
2018-11-27 08:25:28.888504: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 08:25:28.888575: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 08:25:28.888598: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 08:25:28.888623: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 08:25:28.888662: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 08:25:28.888715: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 08:25:28.888735: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 08:25:28.888743: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 08:25:28.888749: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 08:25:28.888754: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 08:25:28.888766: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 08:25:28.888797: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 08:25:28.888804: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 08:25:28.888811: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 08:25:28.888820: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 08:25:28.888848: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 08:25:28.888860: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 08:25:28.888867: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 08:25:28.888962: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 08:25:28.888995: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 08:25:28.889036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 08:25:28.889072: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 08:25:28.889093: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 08:25:28.889102: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 08:25:28.889109: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 08:25:28.889161: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 08:25:28.889193: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 08:25:28.889206: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 08:25:28.889219: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 08:25:28.889251: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 08:25:28.890064: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 08:25:28.890117: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 08:25:28.890155: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 08:25:28.890200: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 08:25:28.890327: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 5
2018-11-27 08:25:28.890348: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 5
[INFO] 2018-11-27T16:25:28z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 08:25:28.960410: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 5
[INFO] 2018-11-27T16:25:28z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 08:25:28.961023: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 5
2018-11-27 08:25:28.961037: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 5
[INFO] 2018-11-27T16:25:28z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T16:25:28z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T16:25:36z src/he_backend.cpp 319	[ Parameter_100 ]
[INFO] 2018-11-27T16:25:36z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T16:25:36z src/he_backend.cpp 319	[ Constant_117 ]
[INFO] 2018-11-27T16:25:36z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:25:36z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:25:36z src/he_backend.cpp 395	Constant_117 took 0s
[INFO] 2018-11-27T16:25:36z src/he_backend.cpp 319	[ Constant_114 ]
[INFO] 2018-11-27T16:25:36z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:25:36z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 395	Constant_114 took 3s
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 319	[ Constant_110 ]
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 395	Constant_110 took 0s
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 319	[ Constant_103 ]
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 395	Constant_103 took 0s
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 319	[ Reshape_102 ]
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 395	Reshape_102 took 0s
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 319	[ Reshape_105 ]
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 395	Reshape_105 took 0s
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 319	[ Reshape_104 ]
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 395	Reshape_104 took 0s
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 319	[ Convolution_106 ]
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:25:39z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:25:48z src/he_backend.cpp 395	Convolution_106 took 8s
[INFO] 2018-11-27T16:25:48z src/he_backend.cpp 319	[ Reshape_107 ]
[INFO] 2018-11-27T16:25:48z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:25:48z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:25:48z src/he_backend.cpp 395	Reshape_107 took 0s
[INFO] 2018-11-27T16:25:48z src/he_backend.cpp 319	[ Multiply_108 ]
[INFO] 2018-11-27T16:25:48z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:25:48z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:25:49z src/he_backend.cpp 395	Multiply_108 took 0s
[INFO] 2018-11-27T16:25:49z src/he_backend.cpp 319	[ Pad_111 ]
[INFO] 2018-11-27T16:25:49z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:25:49z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:25:49z src/he_backend.cpp 395	Pad_111 took 0s
[INFO] 2018-11-27T16:25:49z src/he_backend.cpp 319	[ Reshape_113 ]
[INFO] 2018-11-27T16:25:49z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:25:49z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:25:49z src/he_backend.cpp 395	Reshape_113 took 0s
[INFO] 2018-11-27T16:25:49z src/he_backend.cpp 319	[ Dot_115 ]
[INFO] 2018-11-27T16:25:49z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:25:49z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:25:49z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T16:26:16z src/he_backend.cpp 395	Dot_115 took 27s
[INFO] 2018-11-27T16:26:16z src/he_backend.cpp 319	[ Multiply_116 ]
[INFO] 2018-11-27T16:26:16z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:26:16z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:26:16z src/he_backend.cpp 395	Multiply_116 took 0s
[INFO] 2018-11-27T16:26:16z src/he_backend.cpp 319	[ Dot_118 ]
[INFO] 2018-11-27T16:26:16z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:26:16z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:26:16z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T16:26:17z src/he_backend.cpp 395	Dot_118 took 0s
[INFO] 2018-11-27T16:26:17z src/he_backend.cpp 319	[ Result_119 ]
[INFO] 2018-11-27T16:26:17z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:26:17z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:26:17z src/he_backend.cpp 395	Result_119 took 0s
2018-11-27 08:26:17.172830: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 5
2018-11-27 08:26:17.412854: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 5
Result
[[-1.71655118 -3.75230622 6.57672691 6.78610325 -3.69469833 -3.98750257 -15.4483309 17.4321594 1.80769587 8.18006325]]
total time trial 5: 50.84926700592041
2018-11-27 08:26:17.424128: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 08:26:17.424175: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 08:26:17.424201: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 08:26:17.424210: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 08:26:17.424219: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 08:26:17.424237: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 08:26:17.424251: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 08:26:17.424261: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 08:26:17.424272: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 08:26:17.424285: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 08:26:17.424296: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 08:26:17.424307: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 08:26:17.424316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 08:26:17.424325: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 08:26:17.424333: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 08:26:17.424339: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 08:26:17.424347: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 08:26:17.424353: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 08:26:17.424369: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 08:26:17.424375: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:26:17.424453: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 08:26:17.424476: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 08:26:17.424484: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 08:26:17.424493: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 08:26:17.424502: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 08:26:17.424511: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 08:26:17.424519: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 08:26:17.424529: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 08:26:17.424538: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 08:26:17.424546: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 08:26:17.424555: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 08:26:17.424563: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 08:26:17.424572: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 08:26:17.424580: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 08:26:17.424589: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 08:26:17.424598: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 08:26:17.424608: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:26:17.424694: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 08:26:17.424719: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 08:26:17.424738: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 08:26:17.424752: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 08:26:17.424767: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 08:26:17.424783: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 08:26:17.424798: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 08:26:17.424818: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 08:26:17.424832: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 08:26:17.424855: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 08:26:17.424869: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 08:26:17.424889: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 08:26:17.424905: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 08:26:17.424919: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 08:26:17.424940: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:26:17.424948: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:26:17.424957: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:26:17.424965: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:26:17.424987: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:26:17.424995: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:26:17.425003: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:26:17.425010: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:26:17.425017: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 08:26:17.425022: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 08:26:17.425036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa8438f0 :: reshape/Reshape/shape [Const]
2018-11-27 08:26:17.425044: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa843968 :: conv1/Const [Const]
2018-11-27 08:26:17.425051: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa8439e0 :: conv1/pad_const [Const]
2018-11-27 08:26:17.425058: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa843a58 :: fc1/Reshape/shape [Const]
2018-11-27 08:26:17.425065: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa843ad0 :: squash/Const [Const]
2018-11-27 08:26:17.425072: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa843b48 :: fc2/Const [Const]
2018-11-27 08:26:17.425079: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa843bc0 :: reshape/Reshape [Reshape]
2018-11-27 08:26:17.425086: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa843c78 :: conv1/Conv2D [Conv2D]
2018-11-27 08:26:17.425093: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa843d30 :: conv1/Square [Square]
2018-11-27 08:26:17.425100: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa843dc8 :: conv1/Pad [Pad]
2018-11-27 08:26:17.425107: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa843e80 :: fc1/Reshape [Reshape]
2018-11-27 08:26:17.425114: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa843f38 :: fc1/MatMul [MatMul]
2018-11-27 08:26:17.425121: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa843ff0 :: fc1/Square [Square]
2018-11-27 08:26:17.425128: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 6: 0xa844088 :: fc2/MatMul [MatMul]
2018-11-27 08:26:17.425195: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 08:26:17.425248: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 6 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 08:26:17.425284: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 6 to fc2/Print[0] in -1, datatype: 1
2018-11-27 08:26:17.425327: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 6 to fc2/Print[1] in -1, datatype: 1
2018-11-27 08:26:17.425338: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 6, datatype: 1
2018-11-27 08:26:17.427288: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 08:26:17.427309: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T16:26:19z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 08:26:19.833765: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 6
2018-11-27 08:26:19.833820: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 08:26:19.833833: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 6
2018-11-27 08:26:19.833842: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_6
2018-11-27 08:26:19.833932: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 08:26:19.834006: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 08:26:19.834029: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 08:26:19.834052: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 08:26:19.834092: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 08:26:19.834140: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 08:26:19.834158: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 08:26:19.834166: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 08:26:19.834172: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 08:26:19.834177: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 08:26:19.834189: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 08:26:19.834220: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 08:26:19.834227: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 08:26:19.834234: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 08:26:19.834242: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 08:26:19.834268: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 08:26:19.834280: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 08:26:19.834287: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 08:26:19.834383: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 08:26:19.834416: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 08:26:19.834459: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 08:26:19.834493: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 08:26:19.834516: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 08:26:19.834526: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 08:26:19.834533: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 08:26:19.834586: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 08:26:19.834614: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 08:26:19.834627: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 08:26:19.834640: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 08:26:19.834673: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 08:26:19.835462: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 08:26:19.835512: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 08:26:19.835549: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 08:26:19.835590: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 08:26:19.835717: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 6
2018-11-27 08:26:19.835735: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 6
[INFO] 2018-11-27T16:26:19z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 08:26:19.906636: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 6
[INFO] 2018-11-27T16:26:19z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 08:26:19.907538: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 6
2018-11-27 08:26:19.907553: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 6
[INFO] 2018-11-27T16:26:19z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T16:26:19z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T16:26:27z src/he_backend.cpp 319	[ Parameter_120 ]
[INFO] 2018-11-27T16:26:27z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T16:26:27z src/he_backend.cpp 319	[ Constant_137 ]
[INFO] 2018-11-27T16:26:27z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:26:27z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:26:27z src/he_backend.cpp 395	Constant_137 took 0s
[INFO] 2018-11-27T16:26:27z src/he_backend.cpp 319	[ Constant_134 ]
[INFO] 2018-11-27T16:26:27z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:26:27z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 395	Constant_134 took 3s
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 319	[ Constant_130 ]
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 395	Constant_130 took 0s
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 319	[ Constant_123 ]
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 395	Constant_123 took 0s
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 319	[ Reshape_122 ]
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 395	Reshape_122 took 0s
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 319	[ Reshape_125 ]
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 395	Reshape_125 took 0s
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 319	[ Reshape_124 ]
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 395	Reshape_124 took 0s
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 319	[ Convolution_126 ]
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:26:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:26:39z src/he_backend.cpp 395	Convolution_126 took 8s
[INFO] 2018-11-27T16:26:39z src/he_backend.cpp 319	[ Reshape_127 ]
[INFO] 2018-11-27T16:26:39z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:26:39z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:26:39z src/he_backend.cpp 395	Reshape_127 took 0s
[INFO] 2018-11-27T16:26:39z src/he_backend.cpp 319	[ Multiply_128 ]
[INFO] 2018-11-27T16:26:39z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:26:39z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:26:40z src/he_backend.cpp 395	Multiply_128 took 0s
[INFO] 2018-11-27T16:26:40z src/he_backend.cpp 319	[ Pad_131 ]
[INFO] 2018-11-27T16:26:40z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:26:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:26:40z src/he_backend.cpp 395	Pad_131 took 0s
[INFO] 2018-11-27T16:26:40z src/he_backend.cpp 319	[ Reshape_133 ]
[INFO] 2018-11-27T16:26:40z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:26:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:26:40z src/he_backend.cpp 395	Reshape_133 took 0s
[INFO] 2018-11-27T16:26:40z src/he_backend.cpp 319	[ Dot_135 ]
[INFO] 2018-11-27T16:26:40z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:26:40z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:26:40z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 395	Dot_135 took 28s
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 319	[ Multiply_136 ]
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 395	Multiply_136 took 0s
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 319	[ Dot_138 ]
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 395	Dot_138 took 0s
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 319	[ Result_139 ]
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:27:09z src/he_backend.cpp 395	Result_139 took 0s
2018-11-27 08:27:09.705614: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 6
2018-11-27 08:27:09.937407: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 6
Result
[[-1.71653259 -3.75229 6.57670832 6.78609228 -3.69469857 -3.98750281 -15.4483147 17.4321404 1.80767703 8.18005085]]
total time trial 6: 52.5208203792572
2018-11-27 08:27:09.947775: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 08:27:09.947820: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 08:27:09.947847: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 08:27:09.947856: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 08:27:09.947866: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 08:27:09.947883: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 08:27:09.947897: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 08:27:09.947907: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 08:27:09.947920: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 08:27:09.947933: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 08:27:09.947944: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 08:27:09.947956: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 08:27:09.947965: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 08:27:09.947974: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 08:27:09.947983: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 08:27:09.947989: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 08:27:09.947997: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 08:27:09.948004: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 08:27:09.948011: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 08:27:09.948017: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:27:09.948079: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 08:27:09.948100: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 08:27:09.948108: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 08:27:09.948117: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 08:27:09.948126: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 08:27:09.948135: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 08:27:09.948143: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 08:27:09.948151: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 08:27:09.948161: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 08:27:09.948169: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 08:27:09.948178: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 08:27:09.948186: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 08:27:09.948195: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 08:27:09.948203: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 08:27:09.948212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 08:27:09.948221: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 08:27:09.948230: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:27:09.948315: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 08:27:09.948340: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 08:27:09.948368: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 08:27:09.948383: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 08:27:09.948398: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 08:27:09.948415: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 08:27:09.948430: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 08:27:09.948450: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 08:27:09.948464: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 08:27:09.948486: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 08:27:09.948500: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 08:27:09.948521: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 08:27:09.948537: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 08:27:09.948551: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 08:27:09.948572: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:27:09.948580: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:27:09.948589: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:27:09.948597: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:27:09.948619: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:27:09.948627: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:27:09.948635: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:27:09.948643: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:27:09.948649: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 08:27:09.948655: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 08:27:09.948669: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa843580 :: reshape/Reshape/shape [Const]
2018-11-27 08:27:09.948677: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa8435f8 :: conv1/Const [Const]
2018-11-27 08:27:09.948684: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa843670 :: conv1/pad_const [Const]
2018-11-27 08:27:09.948692: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa8436e8 :: fc1/Reshape/shape [Const]
2018-11-27 08:27:09.948699: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa843760 :: squash/Const [Const]
2018-11-27 08:27:09.948706: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa8437d8 :: fc2/Const [Const]
2018-11-27 08:27:09.948713: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa843850 :: reshape/Reshape [Reshape]
2018-11-27 08:27:09.948720: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa843908 :: conv1/Conv2D [Conv2D]
2018-11-27 08:27:09.948727: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa8439c0 :: conv1/Square [Square]
2018-11-27 08:27:09.948734: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa843a58 :: conv1/Pad [Pad]
2018-11-27 08:27:09.948741: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa843b10 :: fc1/Reshape [Reshape]
2018-11-27 08:27:09.948749: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa843bc8 :: fc1/MatMul [MatMul]
2018-11-27 08:27:09.948756: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa843c80 :: fc1/Square [Square]
2018-11-27 08:27:09.948762: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 7: 0xa843d18 :: fc2/MatMul [MatMul]
2018-11-27 08:27:09.948828: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 08:27:09.948880: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 7 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 08:27:09.948915: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 7 to fc2/Print[0] in -1, datatype: 1
2018-11-27 08:27:09.948955: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 7 to fc2/Print[1] in -1, datatype: 1
2018-11-27 08:27:09.948966: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 7, datatype: 1
2018-11-27 08:27:09.951212: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 08:27:09.951275: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T16:27:12z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 08:27:12.359455: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 7
2018-11-27 08:27:12.359524: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 08:27:12.359537: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 7
2018-11-27 08:27:12.359552: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_7
2018-11-27 08:27:12.359637: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 08:27:12.359709: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 08:27:12.359731: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 08:27:12.359755: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 08:27:12.359793: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 08:27:12.359842: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 08:27:12.359860: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 08:27:12.359868: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 08:27:12.359873: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 08:27:12.359879: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 08:27:12.359891: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 08:27:12.359922: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 08:27:12.359929: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 08:27:12.359936: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 08:27:12.359944: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 08:27:12.359970: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 08:27:12.359982: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 08:27:12.359989: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 08:27:12.360083: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 08:27:12.360116: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 08:27:12.360160: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 08:27:12.360194: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 08:27:12.360216: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 08:27:12.360225: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 08:27:12.360232: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 08:27:12.360286: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 08:27:12.360315: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 08:27:12.360328: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 08:27:12.360341: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 08:27:12.360385: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 08:27:12.361024: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 08:27:12.361072: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 08:27:12.361109: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 08:27:12.361151: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 08:27:12.361277: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 7
2018-11-27 08:27:12.361295: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 7
[INFO] 2018-11-27T16:27:12z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 08:27:12.406228: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 7
[INFO] 2018-11-27T16:27:12z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 08:27:12.406725: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 7
2018-11-27 08:27:12.406758: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 7
[INFO] 2018-11-27T16:27:12z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T16:27:12z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T16:27:19z src/he_backend.cpp 319	[ Parameter_140 ]
[INFO] 2018-11-27T16:27:19z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T16:27:19z src/he_backend.cpp 319	[ Constant_157 ]
[INFO] 2018-11-27T16:27:19z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:27:19z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:27:20z src/he_backend.cpp 395	Constant_157 took 0s
[INFO] 2018-11-27T16:27:20z src/he_backend.cpp 319	[ Constant_154 ]
[INFO] 2018-11-27T16:27:20z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:27:20z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 395	Constant_154 took 2s
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 319	[ Constant_150 ]
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 395	Constant_150 took 0s
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 319	[ Constant_143 ]
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 395	Constant_143 took 0s
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 319	[ Reshape_142 ]
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 395	Reshape_142 took 0s
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 319	[ Reshape_145 ]
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 395	Reshape_145 took 0s
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 319	[ Reshape_144 ]
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 395	Reshape_144 took 0s
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 319	[ Convolution_146 ]
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:27:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:27:31z src/he_backend.cpp 395	Convolution_146 took 8s
[INFO] 2018-11-27T16:27:31z src/he_backend.cpp 319	[ Reshape_147 ]
[INFO] 2018-11-27T16:27:31z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:27:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:27:31z src/he_backend.cpp 395	Reshape_147 took 0s
[INFO] 2018-11-27T16:27:31z src/he_backend.cpp 319	[ Multiply_148 ]
[INFO] 2018-11-27T16:27:31z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:27:31z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:27:32z src/he_backend.cpp 395	Multiply_148 took 0s
[INFO] 2018-11-27T16:27:32z src/he_backend.cpp 319	[ Pad_151 ]
[INFO] 2018-11-27T16:27:32z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:27:32z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:27:32z src/he_backend.cpp 395	Pad_151 took 0s
[INFO] 2018-11-27T16:27:32z src/he_backend.cpp 319	[ Reshape_153 ]
[INFO] 2018-11-27T16:27:32z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:27:32z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:27:32z src/he_backend.cpp 395	Reshape_153 took 0s
[INFO] 2018-11-27T16:27:32z src/he_backend.cpp 319	[ Dot_155 ]
[INFO] 2018-11-27T16:27:32z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:27:32z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:27:32z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 395	Dot_155 took 27s
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 319	[ Multiply_156 ]
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 395	Multiply_156 took 0s
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 319	[ Dot_158 ]
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 395	Dot_158 took 0s
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 319	[ Result_159 ]
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:27:59z src/he_backend.cpp 395	Result_159 took 0s
2018-11-27 08:28:00.007024: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 7
2018-11-27 08:28:00.255271: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 7
Result
[[-1.71897745 -3.752666 6.57792807 6.78534412 -3.69273639 -3.987324 -15.4470415 17.4308891 1.80967772 8.18170834]]
total time trial 7: 50.31459283828735
2018-11-27 08:28:00.266994: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 08:28:00.267040: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 08:28:00.267052: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 08:28:00.267061: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 08:28:00.267070: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 08:28:00.267079: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 08:28:00.267092: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 08:28:00.267102: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 08:28:00.267113: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 08:28:00.267126: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 08:28:00.267136: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 08:28:00.267148: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 08:28:00.267157: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 08:28:00.267166: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 08:28:00.267174: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 08:28:00.267180: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 08:28:00.267189: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 08:28:00.267195: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 08:28:00.267202: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 08:28:00.267208: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:28:00.267286: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 08:28:00.267307: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 08:28:00.267316: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 08:28:00.267324: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 08:28:00.267334: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 08:28:00.267342: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 08:28:00.267351: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 08:28:00.267359: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 08:28:00.267368: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 08:28:00.267377: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 08:28:00.267385: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 08:28:00.267394: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 08:28:00.267403: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 08:28:00.267411: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 08:28:00.267420: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 08:28:00.267429: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 08:28:00.267439: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:28:00.267523: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 08:28:00.267548: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 08:28:00.267567: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 08:28:00.267581: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 08:28:00.267596: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 08:28:00.267613: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 08:28:00.267627: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 08:28:00.267647: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 08:28:00.267661: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 08:28:00.267684: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 08:28:00.267698: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 08:28:00.267719: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 08:28:00.267735: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 08:28:00.267749: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 08:28:00.267770: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:28:00.267778: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:28:00.267787: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:28:00.267794: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:28:00.267817: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:28:00.267824: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:28:00.267833: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:28:00.267840: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:28:00.267847: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 08:28:00.267853: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 08:28:00.267870: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa846f50 :: reshape/Reshape/shape [Const]
2018-11-27 08:28:00.267878: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa846fc8 :: conv1/Const [Const]
2018-11-27 08:28:00.267885: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa847040 :: conv1/pad_const [Const]
2018-11-27 08:28:00.267892: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa8470b8 :: fc1/Reshape/shape [Const]
2018-11-27 08:28:00.267900: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa847130 :: squash/Const [Const]
2018-11-27 08:28:00.267906: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa8471a8 :: fc2/Const [Const]
2018-11-27 08:28:00.267914: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa847220 :: reshape/Reshape [Reshape]
2018-11-27 08:28:00.267921: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa8472d8 :: conv1/Conv2D [Conv2D]
2018-11-27 08:28:00.267928: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa847390 :: conv1/Square [Square]
2018-11-27 08:28:00.267935: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa847428 :: conv1/Pad [Pad]
2018-11-27 08:28:00.267942: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa8474e0 :: fc1/Reshape [Reshape]
2018-11-27 08:28:00.267949: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa847598 :: fc1/MatMul [MatMul]
2018-11-27 08:28:00.267956: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa847650 :: fc1/Square [Square]
2018-11-27 08:28:00.267963: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 8: 0xa8476e8 :: fc2/MatMul [MatMul]
2018-11-27 08:28:00.268030: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 08:28:00.268082: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 8 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 08:28:00.268118: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 8 to fc2/Print[0] in -1, datatype: 1
2018-11-27 08:28:00.268160: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 8 to fc2/Print[1] in -1, datatype: 1
2018-11-27 08:28:00.268172: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 8, datatype: 1
2018-11-27 08:28:00.269751: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 08:28:00.269802: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T16:28:02z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 08:28:02.594273: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 8
2018-11-27 08:28:02.594321: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 08:28:02.594348: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 8
2018-11-27 08:28:02.594357: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_8
2018-11-27 08:28:02.594492: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 08:28:02.594566: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 08:28:02.594589: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 08:28:02.594615: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 08:28:02.594657: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 08:28:02.594708: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 08:28:02.594728: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 08:28:02.594736: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 08:28:02.594742: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 08:28:02.594748: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 08:28:02.594761: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 08:28:02.594793: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 08:28:02.594801: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 08:28:02.594809: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 08:28:02.594819: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 08:28:02.594849: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 08:28:02.594862: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 08:28:02.594870: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 08:28:02.594973: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 08:28:02.595008: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 08:28:02.595056: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 08:28:02.595094: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 08:28:02.595119: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 08:28:02.595130: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 08:28:02.595137: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 08:28:02.595193: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 08:28:02.595227: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 08:28:02.595242: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 08:28:02.595258: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 08:28:02.595292: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 08:28:02.595972: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 08:28:02.596029: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 08:28:02.596069: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 08:28:02.596117: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 08:28:02.596247: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 8
2018-11-27 08:28:02.596269: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 8
[INFO] 2018-11-27T16:28:02z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 08:28:02.627062: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 8
[INFO] 2018-11-27T16:28:02z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 08:28:02.627377: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 8
2018-11-27 08:28:02.627399: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 8
[INFO] 2018-11-27T16:28:02z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T16:28:02z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T16:28:10z src/he_backend.cpp 319	[ Parameter_160 ]
[INFO] 2018-11-27T16:28:10z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T16:28:10z src/he_backend.cpp 319	[ Constant_177 ]
[INFO] 2018-11-27T16:28:10z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:28:10z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:28:10z src/he_backend.cpp 395	Constant_177 took 0s
[INFO] 2018-11-27T16:28:10z src/he_backend.cpp 319	[ Constant_174 ]
[INFO] 2018-11-27T16:28:10z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:28:10z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 395	Constant_174 took 3s
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 319	[ Constant_170 ]
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 395	Constant_170 took 0s
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 319	[ Constant_163 ]
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 395	Constant_163 took 0s
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 319	[ Reshape_162 ]
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 395	Reshape_162 took 0s
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 319	[ Reshape_165 ]
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 395	Reshape_165 took 0s
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 319	[ Reshape_164 ]
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 395	Reshape_164 took 0s
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 319	[ Convolution_166 ]
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:28:13z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 395	Convolution_166 took 8s
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 319	[ Reshape_167 ]
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 395	Reshape_167 took 0s
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 319	[ Multiply_168 ]
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 395	Multiply_168 took 0s
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 319	[ Pad_171 ]
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 395	Pad_171 took 0s
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 319	[ Reshape_173 ]
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 395	Reshape_173 took 0s
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 319	[ Dot_175 ]
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:28:22z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 395	Dot_175 took 28s
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 319	[ Multiply_176 ]
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 395	Multiply_176 took 0s
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 319	[ Dot_178 ]
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 395	Dot_178 took 0s
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 319	[ Result_179 ]
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:28:51z src/he_backend.cpp 395	Result_179 took 0s
2018-11-27 08:28:51.962341: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 8
2018-11-27 08:28:52.174369: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 8
Result
[[-1.71888065 -3.75305486 6.57818079 6.78592253 -3.693326 -3.98736429 -15.4479132 17.4318314 1.80969369 8.18166]]
total time trial 8: 51.9144127368927
2018-11-27 08:28:52.184983: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 08:28:52.185049: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 08:28:52.185081: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 08:28:52.185111: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 08:28:52.185120: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 08:28:52.185129: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 08:28:52.185143: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 08:28:52.185153: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 08:28:52.185165: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 08:28:52.185179: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 08:28:52.185188: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 08:28:52.185199: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 08:28:52.185208: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 08:28:52.185218: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 08:28:52.185226: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 08:28:52.185233: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 08:28:52.185240: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 08:28:52.185246: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 08:28:52.185253: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 08:28:52.185259: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:28:52.185305: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 08:28:52.185322: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 08:28:52.185331: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 08:28:52.185340: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 08:28:52.185350: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 08:28:52.185358: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 08:28:52.185367: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 08:28:52.185375: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 08:28:52.185384: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 08:28:52.185393: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 08:28:52.185401: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 08:28:52.185409: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 08:28:52.185418: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 08:28:52.185426: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 08:28:52.185435: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 08:28:52.185443: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 08:28:52.185453: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:28:52.185527: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 08:28:52.185548: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 08:28:52.185566: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 08:28:52.185580: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 08:28:52.185594: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 08:28:52.185611: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 08:28:52.185625: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 08:28:52.185645: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 08:28:52.185660: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 08:28:52.185682: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 08:28:52.185696: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 08:28:52.185717: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 08:28:52.185733: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 08:28:52.185747: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 08:28:52.185768: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:28:52.185776: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:28:52.185784: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:28:52.185792: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:28:52.185814: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:28:52.185822: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:28:52.185830: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:28:52.185837: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:28:52.185844: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 08:28:52.185849: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 08:28:52.185863: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c79c0 :: reshape/Reshape/shape [Const]
2018-11-27 08:28:52.185870: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c7a38 :: conv1/Const [Const]
2018-11-27 08:28:52.185878: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c7ab0 :: conv1/pad_const [Const]
2018-11-27 08:28:52.185885: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c7b28 :: fc1/Reshape/shape [Const]
2018-11-27 08:28:52.185892: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c7ba0 :: squash/Const [Const]
2018-11-27 08:28:52.185899: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c7c18 :: fc2/Const [Const]
2018-11-27 08:28:52.185906: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c7c90 :: reshape/Reshape [Reshape]
2018-11-27 08:28:52.185913: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c7d48 :: conv1/Conv2D [Conv2D]
2018-11-27 08:28:52.185921: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c7e00 :: conv1/Square [Square]
2018-11-27 08:28:52.185928: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c7e98 :: conv1/Pad [Pad]
2018-11-27 08:28:52.185935: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c7f50 :: fc1/Reshape [Reshape]
2018-11-27 08:28:52.185942: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c8008 :: fc1/MatMul [MatMul]
2018-11-27 08:28:52.185949: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c80c0 :: fc1/Square [Square]
2018-11-27 08:28:52.185956: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 9: 0x97c8158 :: fc2/MatMul [MatMul]
2018-11-27 08:28:52.186022: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 08:28:52.186069: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 9 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 08:28:52.186102: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 9 to fc2/Print[0] in -1, datatype: 1
2018-11-27 08:28:52.186134: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 9 to fc2/Print[1] in -1, datatype: 1
2018-11-27 08:28:52.186145: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 9, datatype: 1
2018-11-27 08:28:52.187699: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 08:28:52.187733: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T16:28:54z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 08:28:54.451868: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 9
2018-11-27 08:28:54.451929: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 08:28:54.451939: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 9
2018-11-27 08:28:54.451946: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_9
2018-11-27 08:28:54.452058: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 08:28:54.452129: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 08:28:54.452151: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 08:28:54.452174: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 08:28:54.452213: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 08:28:54.452262: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 08:28:54.452282: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 08:28:54.452289: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 08:28:54.452295: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 08:28:54.452300: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 08:28:54.452312: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 08:28:54.452342: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 08:28:54.452349: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 08:28:54.452369: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 08:28:54.452378: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 08:28:54.452408: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 08:28:54.452420: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 08:28:54.452427: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 08:28:54.452524: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 08:28:54.452558: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 08:28:54.452601: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 08:28:54.452635: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 08:28:54.452657: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 08:28:54.452667: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 08:28:54.452674: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 08:28:54.452725: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 08:28:54.452755: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 08:28:54.452769: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 08:28:54.452782: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 08:28:54.452815: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 08:28:54.453483: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 08:28:54.453535: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 08:28:54.453571: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 08:28:54.453613: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 08:28:54.453740: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 9
2018-11-27 08:28:54.453759: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 9
[INFO] 2018-11-27T16:28:54z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 08:28:54.525626: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 9
[INFO] 2018-11-27T16:28:54z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 08:28:54.526071: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 9
2018-11-27 08:28:54.526087: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 9
[INFO] 2018-11-27T16:28:54z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T16:28:54z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T16:29:02z src/he_backend.cpp 319	[ Parameter_180 ]
[INFO] 2018-11-27T16:29:02z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T16:29:02z src/he_backend.cpp 319	[ Constant_197 ]
[INFO] 2018-11-27T16:29:02z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:29:02z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:29:02z src/he_backend.cpp 395	Constant_197 took 0s
[INFO] 2018-11-27T16:29:02z src/he_backend.cpp 319	[ Constant_194 ]
[INFO] 2018-11-27T16:29:02z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:29:02z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 395	Constant_194 took 3s
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 319	[ Constant_190 ]
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 395	Constant_190 took 0s
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 319	[ Constant_183 ]
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 395	Constant_183 took 0s
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 319	[ Reshape_182 ]
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 395	Reshape_182 took 0s
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 319	[ Reshape_185 ]
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 395	Reshape_185 took 0s
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 319	[ Reshape_184 ]
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 395	Reshape_184 took 0s
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 319	[ Convolution_186 ]
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:29:05z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:29:14z src/he_backend.cpp 395	Convolution_186 took 8s
[INFO] 2018-11-27T16:29:14z src/he_backend.cpp 319	[ Reshape_187 ]
[INFO] 2018-11-27T16:29:14z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:29:14z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:29:14z src/he_backend.cpp 395	Reshape_187 took 0s
[INFO] 2018-11-27T16:29:14z src/he_backend.cpp 319	[ Multiply_188 ]
[INFO] 2018-11-27T16:29:14z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:29:14z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:29:15z src/he_backend.cpp 395	Multiply_188 took 0s
[INFO] 2018-11-27T16:29:15z src/he_backend.cpp 319	[ Pad_191 ]
[INFO] 2018-11-27T16:29:15z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:29:15z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:29:15z src/he_backend.cpp 395	Pad_191 took 0s
[INFO] 2018-11-27T16:29:15z src/he_backend.cpp 319	[ Reshape_193 ]
[INFO] 2018-11-27T16:29:15z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:29:15z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:29:15z src/he_backend.cpp 395	Reshape_193 took 0s
[INFO] 2018-11-27T16:29:15z src/he_backend.cpp 319	[ Dot_195 ]
[INFO] 2018-11-27T16:29:15z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:29:15z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:29:15z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T16:29:43z src/he_backend.cpp 395	Dot_195 took 28s
[INFO] 2018-11-27T16:29:43z src/he_backend.cpp 319	[ Multiply_196 ]
[INFO] 2018-11-27T16:29:43z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:29:43z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:29:43z src/he_backend.cpp 395	Multiply_196 took 0s
[INFO] 2018-11-27T16:29:43z src/he_backend.cpp 319	[ Dot_198 ]
[INFO] 2018-11-27T16:29:43z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:29:43z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:29:43z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T16:29:44z src/he_backend.cpp 395	Dot_198 took 0s
[INFO] 2018-11-27T16:29:44z src/he_backend.cpp 319	[ Result_199 ]
[INFO] 2018-11-27T16:29:44z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:29:44z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:29:44z src/he_backend.cpp 395	Result_199 took 0s
2018-11-27 08:29:44.607595: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 9
2018-11-27 08:29:44.841909: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 9
Result
[[-1.71758831 -3.75258231 6.5773325 6.78594208 -3.6940124 -3.98743701 -15.4480276 17.4318867 1.80857277 8.18077]]
total time trial 9: 52.66425442695618
2018-11-27 08:29:44.853157: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape/shape[Const]
2018-11-27 08:29:44.853183: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Const[Const]
2018-11-27 08:29:44.853193: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/pad_const[Const]
2018-11-27 08:29:44.853217: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape/shape[Const]
2018-11-27 08:29:44.853227: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: squash/Const[Const]
2018-11-27 08:29:44.853237: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/Const[Const]
2018-11-27 08:29:44.853254: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: reshape/Reshape[Reshape]
2018-11-27 08:29:44.853264: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Conv2D[Conv2D]
2018-11-27 08:29:44.853275: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Square[Square]
2018-11-27 08:29:44.853288: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: conv1/Pad[Pad]
2018-11-27 08:29:44.853297: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Reshape[Reshape]
2018-11-27 08:29:44.853310: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/MatMul[MatMul]
2018-11-27 08:29:44.853319: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc1/Square[Square]
2018-11-27 08:29:44.853330: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:553] Accepting: fc2/MatMul[MatMul]
2018-11-27 08:29:44.853338: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: fc2/Print
2018-11-27 08:29:44.853344: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: fc2/Print[Print]
2018-11-27 08:29:44.853352: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _arg_Placeholder_0_0
2018-11-27 08:29:44.853358: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _arg_Placeholder_0_0[_Arg]
2018-11-27 08:29:44.853365: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:531] Node does not meet confirmation constraints: _retval_fc2/Print_0_0
2018-11-27 08:29:44.853371: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_mark_for_clustering.cc:557] Rejecting: _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:29:44.853419: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 0 for reshape/Reshape/shape[Const]
2018-11-27 08:29:44.853436: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 1 for conv1/Const[Const]
2018-11-27 08:29:44.853444: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 2 for conv1/pad_const[Const]
2018-11-27 08:29:44.853453: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 3 for fc1/Reshape/shape[Const]
2018-11-27 08:29:44.853462: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 4 for squash/Const[Const]
2018-11-27 08:29:44.853471: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 5 for fc2/Const[Const]
2018-11-27 08:29:44.853479: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 6 for reshape/Reshape[Reshape]
2018-11-27 08:29:44.853488: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 7 for conv1/Conv2D[Conv2D]
2018-11-27 08:29:44.853497: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 8 for conv1/Square[Square]
2018-11-27 08:29:44.853505: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 9 for conv1/Pad[Pad]
2018-11-27 08:29:44.853514: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 10 for fc1/Reshape[Reshape]
2018-11-27 08:29:44.853523: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 11 for fc1/MatMul[MatMul]
2018-11-27 08:29:44.853531: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 12 for fc1/Square[Square]
2018-11-27 08:29:44.853540: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 13 for fc2/MatMul[MatMul]
2018-11-27 08:29:44.853548: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 14 for fc2/Print[Print]
2018-11-27 08:29:44.853557: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 15 for _arg_Placeholder_0_0[_Arg]
2018-11-27 08:29:44.853567: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:96] Creating cycle graph node: 16 for _retval_fc2/Print_0_0[_Retval]
2018-11-27 08:29:44.853641: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:173] Starting contraction
2018-11-27 08:29:44.853664: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape/shape[0]@0 -> reshape/Reshape[1]@6
2018-11-27 08:29:44.853681: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: reshape/Reshape[0]@0 -> conv1/Conv2D[0]@7
2018-11-27 08:29:44.853695: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Const[0]@1 -> conv1/Conv2D[1]@0
2018-11-27 08:29:44.853709: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Conv2D[0]@1 -> conv1/Square[0]@8
2018-11-27 08:29:44.853726: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Square[0]@1 -> conv1/Pad[0]@9
2018-11-27 08:29:44.853740: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/pad_const[0]@2 -> conv1/Pad[1]@1
2018-11-27 08:29:44.853760: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: conv1/Pad[0]@2 -> fc1/Reshape[0]@10
2018-11-27 08:29:44.853775: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape/shape[0]@3 -> fc1/Reshape[1]@2
2018-11-27 08:29:44.853797: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Reshape[0]@3 -> fc1/MatMul[0]@11
2018-11-27 08:29:44.853811: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: squash/Const[0]@4 -> fc1/MatMul[1]@3
2018-11-27 08:29:44.853831: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/MatMul[0]@4 -> fc1/Square[0]@12
2018-11-27 08:29:44.853847: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc1/Square[0]@4 -> fc2/MatMul[0]@13
2018-11-27 08:29:44.853861: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:200] Contracting: fc2/Const[0]@5 -> fc2/MatMul[1]@4
2018-11-27 08:29:44.853882: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:29:44.853890: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:29:44.853899: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:29:44.853906: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:29:44.853928: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[0]@14
2018-11-27 08:29:44.853936: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/MatMul[0]@5 -> fc2/Print[1]@14
2018-11-27 08:29:44.853945: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): _arg_Placeholder_0_0[0]@15 -> reshape/Reshape[0]@5
2018-11-27 08:29:44.853952: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:191] Skipping (not marked): fc2/Print[0]@14 -> _retval_fc2/Print_0_0[0]@16
2018-11-27 08:29:44.853958: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:216] Contraction done
2018-11-27 08:29:44.853964: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:218] Starting tagging
2018-11-27 08:29:44.853979: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85c2a0 :: reshape/Reshape/shape [Const]
2018-11-27 08:29:44.853986: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85c318 :: conv1/Const [Const]
2018-11-27 08:29:44.853994: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85c390 :: conv1/pad_const [Const]
2018-11-27 08:29:44.854001: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85c408 :: fc1/Reshape/shape [Const]
2018-11-27 08:29:44.854008: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85c480 :: squash/Const [Const]
2018-11-27 08:29:44.854015: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85c4f8 :: fc2/Const [Const]
2018-11-27 08:29:44.854022: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85c570 :: reshape/Reshape [Reshape]
2018-11-27 08:29:44.854029: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85c628 :: conv1/Conv2D [Conv2D]
2018-11-27 08:29:44.854036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85c6e0 :: conv1/Square [Square]
2018-11-27 08:29:44.854043: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85c778 :: conv1/Pad [Pad]
2018-11-27 08:29:44.854050: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85c830 :: fc1/Reshape [Reshape]
2018-11-27 08:29:44.854057: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85c8e8 :: fc1/MatMul [MatMul]
2018-11-27 08:29:44.854065: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85c9a0 :: fc1/Square [Square]
2018-11-27 08:29:44.854071: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:256] >> cluster 10: 0xa85ca38 :: fc2/MatMul [MatMul]
2018-11-27 08:29:44.854138: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_assign_clusters.cc:274] Tagging done
2018-11-27 08:29:44.854185: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:111] setting cluster 10 requested device to '/job:localhost/replica:0/task:0/device:CPU:0'
2018-11-27 08:29:44.854218: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 10 to fc2/Print[0] in -1, datatype: 1
2018-11-27 08:29:44.854250: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found out-flow: fc2/MatMul[0] in 10 to fc2/Print[1] in -1, datatype: 1
2018-11-27 08:29:44.854262: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_clusters.cc:160] found in-flow: _arg_Placeholder_0_0[0] in -1 to reshape/Reshape[0] in 10, datatype: 1
2018-11-27 08:29:44.855479: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:111] For arg 0 checking edge [id=1 ngraph_input_0:0 -> reshape/Reshape:0]
2018-11-27 08:29:44.855513: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:121] Marking arg 0 is_static: 0
[INFO] 2018-11-27T16:29:47z src/seal/he_seal_util.hpp 47
/ Encryption parameters:
| scheme: HE:SEAL:CKKS
| poly_modulus: 16384
| coeff_modulus size: 280 bits
\ noise_standard_deviation: 3.19
2018-11-27 08:29:47.216115: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:224] NGraphEncapsulateOp::Compute starting for cluster 10
2018-11-27 08:29:47.216167: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:255] Computed signature: 1,784,;/
2018-11-27 08:29:47.216177: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:260] NGraphEncapsulateOp::Compute got inputs for cluster 10
2018-11-27 08:29:47.216184: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:267] Compilation cache miss: ngraph_cluster_10
2018-11-27 08:29:47.216291: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape/shape which is Const
2018-11-27 08:29:47.216370: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op reshape/Reshape which is Reshape
2018-11-27 08:29:47.216393: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 784
2018-11-27 08:29:47.216417: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 28, 28, 1
2018-11-27 08:29:47.216459: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Const which is Const
2018-11-27 08:29:47.216510: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Conv2D which is Conv2D
2018-11-27 08:29:47.216530: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1094] 1, 2, 2, 1
2018-11-27 08:29:47.216538: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1095] 1, 1, 1, 1
2018-11-27 08:29:47.216544: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1096] VALID
2018-11-27 08:29:47.216550: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1097] NHWC
2018-11-27 08:29:47.216562: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 28, 28, 1 to 1, 1, 28, 28
2018-11-27 08:29:47.216595: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1109] ng_strides: 2, 2
2018-11-27 08:29:47.216603: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1110] ng_dilations: 1, 1
2018-11-27 08:29:47.216611: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1111] ng_image_shape: 28, 28
2018-11-27 08:29:47.216620: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 5, 5, 1, 5 to 5, 1, 5, 5
2018-11-27 08:29:47.216650: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:1118] ng_kernel_shape: 5, 5
2018-11-27 08:29:47.216663: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:87] ng_padding_below: 0, 0
2018-11-27 08:29:47.216671: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.h:88] ng_padding_above: 0, 0
2018-11-27 08:29:47.216771: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_conversions.h:34] reshaping 1, 5, 12, 12 to 1, 12, 12, 5
2018-11-27 08:29:47.216805: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Square which is Square
2018-11-27 08:29:47.216851: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/pad_const which is Const
2018-11-27 08:29:47.216888: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op conv1/Pad which is Pad
2018-11-27 08:29:47.216912: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2230] {0, 0, 0, 1, 0, 1, 0, 0}
2018-11-27 08:29:47.216923: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2248] {0, 0, 0, 0}
2018-11-27 08:29:47.216931: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2249] {0, 1, 1, 0}
2018-11-27 08:29:47.216988: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape/shape which is Const
2018-11-27 08:29:47.217021: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Reshape which is Reshape
2018-11-27 08:29:47.217036: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2731] Input shape: 1, 13, 13, 5
2018-11-27 08:29:47.217051: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:2736] Requested result shape: -1, 845
2018-11-27 08:29:47.217086: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op squash/Const which is Const
2018-11-27 08:29:47.217743: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/MatMul which is MatMul
2018-11-27 08:29:47.217801: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc1/Square which is Square
2018-11-27 08:29:47.217843: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/Const which is Const
2018-11-27 08:29:47.217892: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_builder.cc:3825] Constructing op fc2/MatMul which is MatMul
2018-11-27 08:29:47.218023: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:295] NGraphEncapsulateOp::Compute got graph for cluster 10
2018-11-27 08:29:47.218044: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:309] NGraphEncapsulateOp::Compute got freshness tracker for cluster 10
[INFO] 2018-11-27T16:29:47z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 784
2018-11-27 08:29:47.245816: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:392] NGraphEncapsulateOp::Compute allocated argument tensors for cluster 10
[INFO] 2018-11-27T16:29:47z src/seal/ckks/he_seal_ckks_backend.cpp 287	Creating batched plain tensor with shape 1, 10
2018-11-27 08:29:47.246144: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:457] NGraphEncapsulateOp::Compute allocated result tensors for cluster 10
2018-11-27 08:29:47.246161: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:464] NGraphEncapsulateOp::Compute call starting for cluster 10
[INFO] 2018-11-27T16:29:47z src/he_backend.cpp 253	Encrypting data
[INFO] 2018-11-27T16:29:47z src/he_backend.cpp 256	Batching data
[INFO] 2018-11-27T16:29:55z src/he_backend.cpp 319	[ Parameter_200 ]
[INFO] 2018-11-27T16:29:55z src/he_backend.cpp 323	Parameter shape {1, 784}
[INFO] 2018-11-27T16:29:55z src/he_backend.cpp 319	[ Constant_217 ]
[INFO] 2018-11-27T16:29:55z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:29:55z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:29:55z src/he_backend.cpp 395	Constant_217 took 0s
[INFO] 2018-11-27T16:29:55z src/he_backend.cpp 319	[ Constant_214 ]
[INFO] 2018-11-27T16:29:55z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:29:55z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 395	Constant_214 took 3s
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 319	[ Constant_210 ]
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 395	Constant_210 took 0s
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 319	[ Constant_203 ]
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 442	Inputs:
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 395	Constant_203 took 0s
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 319	[ Reshape_202 ]
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 395	Reshape_202 took 0s
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 319	[ Reshape_205 ]
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 442	Inputs: Plain
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 395	Reshape_205 took 0s
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 319	[ Reshape_204 ]
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 395	Reshape_204 took 0s
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 319	[ Convolution_206 ]
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:29:58z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 395	Convolution_206 took 8s
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 319	[ Reshape_207 ]
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 395	Reshape_207 took 0s
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 319	[ Multiply_208 ]
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 395	Multiply_208 took 0s
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 319	[ Pad_211 ]
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 395	Pad_211 took 0s
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 319	[ Reshape_213 ]
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 395	Reshape_213 took 0s
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 319	[ Dot_215 ]
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:30:07z src/he_backend.cpp 568	1x845 dot 845x100
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 395	Dot_215 took 28s
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 319	[ Multiply_216 ]
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 442	Inputs: Cipher, Cipher
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 395	Multiply_216 took 0s
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 319	[ Dot_218 ]
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 442	Inputs: Cipher, Plain
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 450	Outputs: Cipher
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 568	1x100 dot 100x10
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 395	Dot_218 took 0s
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 319	[ Result_219 ]
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 442	Inputs: Cipher
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 450	Outputs: Plain
[INFO] 2018-11-27T16:30:36z src/he_backend.cpp 395	Result_219 took 0s
2018-11-27 08:30:36.835604: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:480] NGraphEncapsulateOp::Compute call done for cluster 10
2018-11-27 08:30:37.058619: I /nfs/site/home/fboemer/repos/he-transformer/build/ext_ngraph_tf/src/ext_ngraph_tf/src/ngraph_encapsulate_op.cc:513] NGraphEncapsulateOp::Compute done marking fresh for cluster 10
Result
[[-1.71464288 -3.75132251 6.57526064 6.7857604 -3.69536805 -3.98758507 -15.4479303 17.4316216 1.80596435 8.17874813]]
total time trial 10: 52.213849782943726
(he3) ➜  cryptonets git:(fboemer/cryptonets-timings) ✗